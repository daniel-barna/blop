<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="../default.css" type="text/css" rel="stylesheet">
<title> BLOP: plot.cc </title>
</head>
<body>

<a href="../index.html" title="Home"> 
<img src="../home.png"  style="border-width:0cm;"> 
</a>
<a href="source.html" title="List of sourcefiles"> 
<img src="../up.png"    style="border-width:0cm;"> 
</a>
 <hr>
<pre>
<a name="__line0"></a>#include "<a href="plot.h.html">plot.h</a>"
<a name="__line1"></a>#include "<a href="frame.h.html">frame.h</a>"
<a name="__line2"></a>#include "<a href="warning.h.html">warning.h</a>"
<a name="__line3"></a>#include "<a href="pstream.h.html">pstream.h</a>"
<a name="__line4"></a>#include &lt;algorithm&gt;
<a name="__line5"></a>#include &lt;cmath&gt;
<a name="__line6"></a>
<a name="__line7"></a>namespace blop
<a name="__line8"></a>{
<a name="__line9"></a>    plotcmd_interpreter* &amp;plotcmd_interpreter::get()
<a name="__line10"></a>    {
<a name="__line11"></a>	static plotcmd_interpreter *c = 0;
<a name="__line12"></a>	return c;
<a name="__line13"></a>    }
<a name="__line14"></a>    void plotcmd_interpreter::set(plotcmd_interpreter *c)
<a name="__line15"></a>    {
<a name="__line16"></a>	get() = c;
<a name="__line17"></a>    }
<a name="__line18"></a>
<a name="__line19"></a>    plottable &amp;plotcmd(const var &amp;cmd)
<a name="__line20"></a>    {
<a name="__line21"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line22"></a>	return mplotcmd(cmd);
<a name="__line23"></a>    }
<a name="__line24"></a>
<a name="__line25"></a>    plottable &amp;mplotcmd(const var &amp;cmd)
<a name="__line26"></a>    {
<a name="__line27"></a>	plotcmd_interpreter *c = plotcmd_interpreter::get();
<a name="__line28"></a>	plottable *p = 0;
<a name="__line29"></a>	if(c == 0 || (p = c-&gt;run(cmd)) == 0)
<a name="__line30"></a>	{
<a name="__line31"></a>	    if(c == 0) warning::print("No plotcmd_interpreter was set",
<a name="__line32"></a>				      "mplot_custom(const var &amp;cmd)");
<a name="__line33"></a>	    static dgraph g;
<a name="__line34"></a>	    return g;
<a name="__line35"></a>	}
<a name="__line36"></a>	frame::current().add(p);
<a name="__line37"></a>	return *p;
<a name="__line38"></a>    }
<a name="__line39"></a>
<a name="__line40"></a>    dgraph &amp;plot_rectangle(const var &amp;x1, const var &amp;y1, const var &amp;x2, const var &amp;y2)
<a name="__line41"></a>    {
<a name="__line42"></a>	double x[5], y[5];
<a name="__line43"></a>	x[0] = x1.dbl();
<a name="__line44"></a>	y[0] = y1.dbl();
<a name="__line45"></a>	x[1] = x2.dbl();
<a name="__line46"></a>	y[1] = y1.dbl();
<a name="__line47"></a>	x[2] = x2.dbl();
<a name="__line48"></a>	y[2] = y2.dbl();
<a name="__line49"></a>	x[3] = x1.dbl();
<a name="__line50"></a>	y[3] = y2.dbl();
<a name="__line51"></a>	x[4] = x1.dbl();
<a name="__line52"></a>	y[4] = y1.dbl();
<a name="__line53"></a>	return plot(5,x,y);
<a name="__line54"></a>    }
<a name="__line55"></a>    dgraph &amp;mplot_rectangle(const var &amp;x1, const var &amp;y1, const var &amp;x2, const var &amp;y2)
<a name="__line56"></a>    {
<a name="__line57"></a>	double x[5], y[5];
<a name="__line58"></a>	x[0] = x1.dbl();
<a name="__line59"></a>	y[0] = y1.dbl();
<a name="__line60"></a>	x[1] = x2.dbl();
<a name="__line61"></a>	y[1] = y1.dbl();
<a name="__line62"></a>	x[2] = x2.dbl();
<a name="__line63"></a>	y[2] = y2.dbl();
<a name="__line64"></a>	x[3] = x1.dbl();
<a name="__line65"></a>	y[3] = y2.dbl();
<a name="__line66"></a>	x[4] = x1.dbl();
<a name="__line67"></a>	y[4] = y1.dbl();
<a name="__line68"></a>	return mplot(5,x,y);
<a name="__line69"></a>    }
<a name="__line70"></a>
<a name="__line71"></a>    fgraph &amp;plot(const function &amp;f1, const function &amp;f2, const function &amp;f3, const function &amp;f4, const function &amp;f5)
<a name="__line72"></a>    {
<a name="__line73"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line74"></a>	return mplot(f1,f2,f3,f4,f5);
<a name="__line75"></a>    }
<a name="__line76"></a>
<a name="__line77"></a>    fgraph &amp;mplot(const function &amp;f1, const function &amp;f2, const function &amp;f3, const function &amp;f4, const function &amp;f5)
<a name="__line78"></a>    {
<a name="__line79"></a>        function f(f1,f2,f3,f4,f5);
<a name="__line80"></a>
<a name="__line81"></a>        if(f.components()==1) f = function(_1,f1,f2,f3,f4,f5);
<a name="__line82"></a>	fgraph *g = new fgraph(f);
<a name="__line83"></a>	g-&gt;autodel(true);
<a name="__line84"></a>	g-&gt;set_default_legend();
<a name="__line85"></a>	frame::current().add(g);
<a name="__line86"></a>	return *g;
<a name="__line87"></a>    }
<a name="__line88"></a>
<a name="__line89"></a>    plottable &amp;mplot(plottable &amp;g)
<a name="__line90"></a>    {
<a name="__line91"></a>	frame::current().add(&amp;g);
<a name="__line92"></a>	return g;
<a name="__line93"></a>    }
<a name="__line94"></a>
<a name="__line95"></a>    plottable &amp;plot(plottable &amp;g)
<a name="__line96"></a>    {
<a name="__line97"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line98"></a>	frame::current().add(&amp;g);
<a name="__line99"></a>	return g;
<a name="__line100"></a>    }
<a name="__line101"></a>
<a name="__line102"></a>
<a name="__line103"></a>    dgraph &amp;mplot(dgraph &amp;g,
<a name="__line104"></a>		  const function &amp;f1,
<a name="__line105"></a>		  const function &amp;f2,
<a name="__line106"></a>		  const function &amp;f3,
<a name="__line107"></a>		  const function &amp;f4)
<a name="__line108"></a>    {
<a name="__line109"></a>	if(!f1.initialized())
<a name="__line110"></a>	{
<a name="__line111"></a>	    frame::current().add(&amp;g);
<a name="__line112"></a>	    return g;
<a name="__line113"></a>	}
<a name="__line114"></a>	function f(f1,f2,f3,f4);
<a name="__line115"></a>	int cols = f.components();
<a name="__line116"></a>
<a name="__line117"></a>	dgraph *gg = new dgraph(g.size(), cols);
<a name="__line118"></a>	for(unsigned int i=0; i&lt;g.size(); ++i)
<a name="__line119"></a>	{
<a name="__line120"></a>            function::clear_named_params();
<a name="__line121"></a>	    function::named_param("linenumber",i);
<a name="__line122"></a>	    f.meval(g[i],(*gg)[i]);
<a name="__line123"></a>	}
<a name="__line124"></a>        function::clear_named_params();
<a name="__line125"></a>	gg-&gt;autodel(true);
<a name="__line126"></a>	gg-&gt;copy_style(g);
<a name="__line127"></a>	frame::current().add(gg);
<a name="__line128"></a>	return *gg;
<a name="__line129"></a>    }
<a name="__line130"></a>
<a name="__line131"></a>    <span class=comment>// ---------- plot_if/mplot_if for vectors ----------------------------------------</span>
<a name="__line132"></a>
<a name="__line133"></a>    dgraph &amp;plot(const std::vector&lt;double&gt; &amp;y)
<a name="__line134"></a>    {
<a name="__line135"></a>        std::vector&lt;double&gt; x(y.size());
<a name="__line136"></a>        for(unsigned int i=0; i&lt;x.size(); ++i) x[i] = i;
<a name="__line137"></a>        return plot(x,y);
<a name="__line138"></a>    }
<a name="__line139"></a>    dgraph &amp;mplot(const std::vector&lt;double&gt; &amp;y)
<a name="__line140"></a>    {
<a name="__line141"></a>        std::vector&lt;double&gt; x(y.size());
<a name="__line142"></a>        for(unsigned int i=0; i&lt;x.size(); ++i) x[i] = i;
<a name="__line143"></a>        return mplot(x,y);
<a name="__line144"></a>    }
<a name="__line145"></a>
<a name="__line146"></a>    dgraph &amp;plot(const std::vector&lt;std::complex&lt;double&gt;&gt; &amp;z)
<a name="__line147"></a>    {
<a name="__line148"></a>        std::vector&lt;double&gt; x(z.size()), y(z.size());
<a name="__line149"></a>        for(unsigned int i=0; i&lt;z.size(); ++i)
<a name="__line150"></a>        {
<a name="__line151"></a>            x[i] = z[i].real();
<a name="__line152"></a>            y[i] = z[i].imag();
<a name="__line153"></a>        }
<a name="__line154"></a>        return plot(x,y);
<a name="__line155"></a>    }
<a name="__line156"></a>    dgraph &amp;mplot(const std::vector&lt;std::complex&lt;double&gt;&gt; &amp;z)
<a name="__line157"></a>    {
<a name="__line158"></a>        std::vector&lt;double&gt; x(z.size()), y(z.size());
<a name="__line159"></a>        for(unsigned int i=0; i&lt;z.size(); ++i)
<a name="__line160"></a>        {
<a name="__line161"></a>            x[i] = z[i].real();
<a name="__line162"></a>            y[i] = z[i].imag();
<a name="__line163"></a>        }
<a name="__line164"></a>        return mplot(x,y);
<a name="__line165"></a>    }
<a name="__line166"></a>
<a name="__line167"></a>    dgraph &amp;mplot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line168"></a>		     const function &amp;condition,
<a name="__line169"></a>		     const function &amp;f1,
<a name="__line170"></a>		     const function &amp;f2,
<a name="__line171"></a>		     const function &amp;f3,
<a name="__line172"></a>		     const function &amp;f4)
<a name="__line173"></a>    {
<a name="__line174"></a>	dgraph *g = new dgraph;
<a name="__line175"></a>	g-&gt;autodel(true);
<a name="__line176"></a>	frame::current().add(g);
<a name="__line177"></a>	if(condition.nargs() &gt; 1)
<a name="__line178"></a>	{
<a name="__line179"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line180"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function&amp; condition, ....)");
<a name="__line181"></a>	    return *g;
<a name="__line182"></a>	}
<a name="__line183"></a>
<a name="__line184"></a>	function f(f1,f2,f3,f4);
<a name="__line185"></a>	const int cols = f.components();
<a name="__line186"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line187"></a>	{
<a name="__line188"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line189"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line190"></a>	}
<a name="__line191"></a>
<a name="__line192"></a>	datapoint p(cols);
<a name="__line193"></a>	vector&lt;var&gt; args(1);
<a name="__line194"></a>	for(unsigned int i=0; i&lt;x.size(); ++i)
<a name="__line195"></a>	{
<a name="__line196"></a>            function::clear_named_params();
<a name="__line197"></a>	    function::named_param("linenumber",i);
<a name="__line198"></a>            
<a name="__line199"></a>	    args[0] = x[i];
<a name="__line200"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line201"></a>	    if(f.initialized())
<a name="__line202"></a>	    {
<a name="__line203"></a>		f.meval(args,p);
<a name="__line204"></a>		g-&gt;add(p);
<a name="__line205"></a>	    }
<a name="__line206"></a>	    else
<a name="__line207"></a>	    {
<a name="__line208"></a>		g-&gt;add(args);
<a name="__line209"></a>	    }
<a name="__line210"></a>	}
<a name="__line211"></a>        function::clear_named_params();
<a name="__line212"></a>	return *g;
<a name="__line213"></a>    }
<a name="__line214"></a>
<a name="__line215"></a>    dgraph &amp;mplot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line216"></a>		     const std::vector&lt;double&gt; &amp;y,
<a name="__line217"></a>		     const function &amp;condition,
<a name="__line218"></a>		     const function &amp;f1,
<a name="__line219"></a>		     const function &amp;f2,
<a name="__line220"></a>		     const function &amp;f3,
<a name="__line221"></a>		     const function &amp;f4)
<a name="__line222"></a>    {
<a name="__line223"></a>	dgraph *g = new dgraph;
<a name="__line224"></a>	g-&gt;autodel(true);
<a name="__line225"></a>	frame::current().add(g);
<a name="__line226"></a>	if(condition.nargs() &gt; 2)
<a name="__line227"></a>	{
<a name="__line228"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line229"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function&amp; condition, ....)");
<a name="__line230"></a>	    return *g;
<a name="__line231"></a>	}
<a name="__line232"></a>
<a name="__line233"></a>	function f(f1,f2,f3,f4);
<a name="__line234"></a>	const int cols = f.components();
<a name="__line235"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line236"></a>	{
<a name="__line237"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line238"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line239"></a>	}
<a name="__line240"></a>
<a name="__line241"></a>	datapoint p(cols);
<a name="__line242"></a>	vector&lt;var&gt; args(2);
<a name="__line243"></a>	const unsigned int npoints = std::min(x.size(), y.size());
<a name="__line244"></a>	for(unsigned int i=0; i&lt;npoints; ++i)
<a name="__line245"></a>	{
<a name="__line246"></a>            function::clear_named_params();
<a name="__line247"></a>	    function::named_param("linenumber",i);
<a name="__line248"></a>	    args[0] = x[i];
<a name="__line249"></a>	    args[1] = y[i];
<a name="__line250"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line251"></a>	    if(f.initialized())
<a name="__line252"></a>	    {
<a name="__line253"></a>		f.meval(args,p);
<a name="__line254"></a>		g-&gt;add(p);
<a name="__line255"></a>	    }
<a name="__line256"></a>	    else
<a name="__line257"></a>	    {
<a name="__line258"></a>		g-&gt;add(args);
<a name="__line259"></a>	    }
<a name="__line260"></a>	}
<a name="__line261"></a>        function::clear_named_params();
<a name="__line262"></a>	return *g;
<a name="__line263"></a>    }
<a name="__line264"></a>
<a name="__line265"></a>    dgraph &amp;mplot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line266"></a>		     const std::vector&lt;double&gt; &amp;y,
<a name="__line267"></a>		     const std::vector&lt;double&gt; &amp;z,
<a name="__line268"></a>		     const function &amp;condition,
<a name="__line269"></a>		     const function &amp;f1,
<a name="__line270"></a>		     const function &amp;f2,
<a name="__line271"></a>		     const function &amp;f3,
<a name="__line272"></a>		     const function &amp;f4)
<a name="__line273"></a>    {
<a name="__line274"></a>	dgraph *g = new dgraph;
<a name="__line275"></a>	g-&gt;autodel(true);
<a name="__line276"></a>	frame::current().add(g);
<a name="__line277"></a>	if(condition.nargs() &gt; 3)
<a name="__line278"></a>	{
<a name="__line279"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line280"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function&amp; condition, ....)");
<a name="__line281"></a>	    return *g;
<a name="__line282"></a>	}
<a name="__line283"></a>
<a name="__line284"></a>	function f(f1,f2,f3,f4);
<a name="__line285"></a>	const int cols = f.components();
<a name="__line286"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line287"></a>	{
<a name="__line288"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line289"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line290"></a>	}
<a name="__line291"></a>
<a name="__line292"></a>	datapoint p(cols);
<a name="__line293"></a>	vector&lt;var&gt; args(3);
<a name="__line294"></a>	const unsigned int npoints = std::min(std::min(x.size(), y.size()),z.size());
<a name="__line295"></a>	for(unsigned int i=0; i&lt;npoints; ++i)
<a name="__line296"></a>	{
<a name="__line297"></a>            function::clear_named_params();
<a name="__line298"></a>	    function::named_param("linenumber",i);
<a name="__line299"></a>	    args[0] = x[i];
<a name="__line300"></a>	    args[1] = y[i];
<a name="__line301"></a>	    args[2] = z[i];
<a name="__line302"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line303"></a>	    if(f.initialized())
<a name="__line304"></a>	    {
<a name="__line305"></a>		f.meval(args,p);
<a name="__line306"></a>		g-&gt;add(p);
<a name="__line307"></a>	    }
<a name="__line308"></a>	    else
<a name="__line309"></a>	    {
<a name="__line310"></a>		g-&gt;add(args);
<a name="__line311"></a>	    }
<a name="__line312"></a>	}
<a name="__line313"></a>        function::clear_named_params();
<a name="__line314"></a>	return *g;
<a name="__line315"></a>    }
<a name="__line316"></a>    dgraph &amp;mplot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line317"></a>		     const std::vector&lt;double&gt; &amp;y,
<a name="__line318"></a>		     const std::vector&lt;double&gt; &amp;z,
<a name="__line319"></a>		     const std::vector&lt;double&gt; &amp;w,
<a name="__line320"></a>		     const function &amp;condition,
<a name="__line321"></a>		     const function &amp;f1,
<a name="__line322"></a>		     const function &amp;f2,
<a name="__line323"></a>		     const function &amp;f3,
<a name="__line324"></a>		     const function &amp;f4)
<a name="__line325"></a>    {
<a name="__line326"></a>	dgraph *g = new dgraph;
<a name="__line327"></a>	g-&gt;autodel(true);
<a name="__line328"></a>	frame::current().add(g);
<a name="__line329"></a>	if(condition.nargs() &gt; 4)
<a name="__line330"></a>	{
<a name="__line331"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line332"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function&amp; condition, ....)");
<a name="__line333"></a>	    return *g;
<a name="__line334"></a>	}
<a name="__line335"></a>
<a name="__line336"></a>	function f(f1,f2,f3,f4);
<a name="__line337"></a>	const int cols = f.components();
<a name="__line338"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line339"></a>	{
<a name="__line340"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line341"></a>			   "mplot_if(vector&lt;double&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line342"></a>	}
<a name="__line343"></a>
<a name="__line344"></a>	datapoint p(cols);
<a name="__line345"></a>	vector&lt;var&gt; args(4);
<a name="__line346"></a>	const unsigned int npoints = std::min(std::min(x.size(), y.size()),z.size());
<a name="__line347"></a>	for(unsigned int i=0; i&lt;npoints; ++i)
<a name="__line348"></a>	{
<a name="__line349"></a>            function::clear_named_params();
<a name="__line350"></a>	    function::named_param("linenumber",i);
<a name="__line351"></a>	    args[0] = x[i];
<a name="__line352"></a>	    args[1] = y[i];
<a name="__line353"></a>	    args[2] = z[i];
<a name="__line354"></a>	    args[3] = w[i];
<a name="__line355"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line356"></a>	    if(f.initialized())
<a name="__line357"></a>	    {
<a name="__line358"></a>		f.meval(args,p);
<a name="__line359"></a>		g-&gt;add(p);
<a name="__line360"></a>	    }
<a name="__line361"></a>	    else
<a name="__line362"></a>	    {
<a name="__line363"></a>		g-&gt;add(args);
<a name="__line364"></a>	    }
<a name="__line365"></a>	}
<a name="__line366"></a>        function::clear_named_params();
<a name="__line367"></a>	return *g;
<a name="__line368"></a>    }
<a name="__line369"></a>
<a name="__line370"></a>    dgraph &amp;plot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line371"></a>		    const function &amp;condition,
<a name="__line372"></a>		    const function &amp;f1,
<a name="__line373"></a>		    const function &amp;f2,
<a name="__line374"></a>		    const function &amp;f3,
<a name="__line375"></a>		    const function &amp;f4)
<a name="__line376"></a>    {
<a name="__line377"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line378"></a>	return mplot_if(x,condition,f1,f2,f3,f4);
<a name="__line379"></a>    }
<a name="__line380"></a>    dgraph &amp;plot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line381"></a>		    const std::vector&lt;double&gt; &amp;y,
<a name="__line382"></a>		    const function &amp;condition,
<a name="__line383"></a>		    const function &amp;f1,
<a name="__line384"></a>		    const function &amp;f2,
<a name="__line385"></a>		    const function &amp;f3,
<a name="__line386"></a>		    const function &amp;f4)
<a name="__line387"></a>    {
<a name="__line388"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line389"></a>	return mplot_if(x,y,condition,f1,f2,f3,f4);
<a name="__line390"></a>    }
<a name="__line391"></a>    dgraph &amp;plot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line392"></a>		    const std::vector&lt;double&gt; &amp;y,
<a name="__line393"></a>		    const std::vector&lt;double&gt; &amp;z,
<a name="__line394"></a>		    const function &amp;condition,
<a name="__line395"></a>		    const function &amp;f1,
<a name="__line396"></a>		    const function &amp;f2,
<a name="__line397"></a>		    const function &amp;f3,
<a name="__line398"></a>		    const function &amp;f4)
<a name="__line399"></a>    {
<a name="__line400"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line401"></a>	return mplot_if(x,y,z,condition,f1,f2,f3,f4);
<a name="__line402"></a>    }
<a name="__line403"></a>    dgraph &amp;plot_if(const std::vector&lt;double&gt; &amp;x,
<a name="__line404"></a>		    const std::vector&lt;double&gt; &amp;y,
<a name="__line405"></a>		    const std::vector&lt;double&gt; &amp;z,
<a name="__line406"></a>		    const std::vector&lt;double&gt; &amp;w,
<a name="__line407"></a>		    const function &amp;condition,
<a name="__line408"></a>		    const function &amp;f1,
<a name="__line409"></a>		    const function &amp;f2,
<a name="__line410"></a>		    const function &amp;f3,
<a name="__line411"></a>		    const function &amp;f4)
<a name="__line412"></a>    {
<a name="__line413"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line414"></a>	return mplot_if(x,y,z,w,condition,f1,f2,f3,f4);
<a name="__line415"></a>    }
<a name="__line416"></a>
<a name="__line417"></a>
<a name="__line418"></a>
<a name="__line419"></a>    dgraph &amp;mplot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line420"></a>		     const function &amp;condition,
<a name="__line421"></a>		     const function &amp;f1,
<a name="__line422"></a>		     const function &amp;f2,
<a name="__line423"></a>		     const function &amp;f3,
<a name="__line424"></a>		     const function &amp;f4)
<a name="__line425"></a>    {
<a name="__line426"></a>	dgraph *g = new dgraph;
<a name="__line427"></a>	g-&gt;autodel(true);
<a name="__line428"></a>	frame::current().add(g);
<a name="__line429"></a>	if(condition.nargs() &gt; 1)
<a name="__line430"></a>	{
<a name="__line431"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line432"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function&amp; condition, ....)");
<a name="__line433"></a>	    return *g;
<a name="__line434"></a>	}
<a name="__line435"></a>
<a name="__line436"></a>	function f(f1,f2,f3,f4);
<a name="__line437"></a>	const int cols = f.components();
<a name="__line438"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line439"></a>	{
<a name="__line440"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line441"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line442"></a>	}
<a name="__line443"></a>
<a name="__line444"></a>	datapoint p(cols);
<a name="__line445"></a>	vector&lt;var&gt; args(1);
<a name="__line446"></a>	for(unsigned int i=0; i&lt;x.size(); ++i)
<a name="__line447"></a>	{
<a name="__line448"></a>            function::clear_named_params();
<a name="__line449"></a>	    function::named_param("linenumber",i);
<a name="__line450"></a>	    args[0] = x[i];
<a name="__line451"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line452"></a>	    if(f.initialized())
<a name="__line453"></a>	    {
<a name="__line454"></a>		f.meval(args,p);
<a name="__line455"></a>		g-&gt;add(p);
<a name="__line456"></a>	    }
<a name="__line457"></a>	    else
<a name="__line458"></a>	    {
<a name="__line459"></a>		g-&gt;add(args);
<a name="__line460"></a>	    }
<a name="__line461"></a>	}
<a name="__line462"></a>        function::clear_named_params();
<a name="__line463"></a>	return *g;
<a name="__line464"></a>    }
<a name="__line465"></a>
<a name="__line466"></a>    dgraph &amp;mplot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line467"></a>		     const std::vector&lt;var&gt; &amp;y,
<a name="__line468"></a>		     const function &amp;condition,
<a name="__line469"></a>		     const function &amp;f1,
<a name="__line470"></a>		     const function &amp;f2,
<a name="__line471"></a>		     const function &amp;f3,
<a name="__line472"></a>		     const function &amp;f4)
<a name="__line473"></a>    {
<a name="__line474"></a>	dgraph *g = new dgraph;
<a name="__line475"></a>	g-&gt;autodel(true);
<a name="__line476"></a>	frame::current().add(g);
<a name="__line477"></a>	if(condition.nargs() &gt; 2)
<a name="__line478"></a>	{
<a name="__line479"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line480"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function&amp; condition, ....)");
<a name="__line481"></a>	    return *g;
<a name="__line482"></a>	}
<a name="__line483"></a>
<a name="__line484"></a>	function f(f1,f2,f3,f4);
<a name="__line485"></a>	const int cols = f.components();
<a name="__line486"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line487"></a>	{
<a name="__line488"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line489"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line490"></a>	}
<a name="__line491"></a>
<a name="__line492"></a>	datapoint p(cols);
<a name="__line493"></a>	vector&lt;var&gt; args(2);
<a name="__line494"></a>	const unsigned int npoints = std::min(x.size(), y.size());
<a name="__line495"></a>	for(unsigned int i=0; i&lt;npoints; ++i)
<a name="__line496"></a>	{
<a name="__line497"></a>            function::clear_named_params();
<a name="__line498"></a>	    function::named_param("linenumber",i);
<a name="__line499"></a>	    args[0] = x[i];
<a name="__line500"></a>	    args[1] = y[i];
<a name="__line501"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line502"></a>	    if(f.initialized())
<a name="__line503"></a>	    {
<a name="__line504"></a>		f.meval(args,p);
<a name="__line505"></a>		g-&gt;add(p);
<a name="__line506"></a>	    }
<a name="__line507"></a>	    else
<a name="__line508"></a>	    {
<a name="__line509"></a>		g-&gt;add(args);
<a name="__line510"></a>	    }
<a name="__line511"></a>	}
<a name="__line512"></a>        function::clear_named_params();
<a name="__line513"></a>	return *g;
<a name="__line514"></a>    }
<a name="__line515"></a>
<a name="__line516"></a>    dgraph &amp;mplot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line517"></a>		     const std::vector&lt;var&gt; &amp;y,
<a name="__line518"></a>		     const std::vector&lt;var&gt; &amp;z,
<a name="__line519"></a>		     const function &amp;condition,
<a name="__line520"></a>		     const function &amp;f1,
<a name="__line521"></a>		     const function &amp;f2,
<a name="__line522"></a>		     const function &amp;f3,
<a name="__line523"></a>		     const function &amp;f4)
<a name="__line524"></a>    {
<a name="__line525"></a>	dgraph *g = new dgraph;
<a name="__line526"></a>	g-&gt;autodel(true);
<a name="__line527"></a>	frame::current().add(g);
<a name="__line528"></a>	if(condition.nargs() &gt; 3)
<a name="__line529"></a>	{
<a name="__line530"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line531"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function&amp; condition, ....)");
<a name="__line532"></a>	    return *g;
<a name="__line533"></a>	}
<a name="__line534"></a>
<a name="__line535"></a>	function f(f1,f2,f3,f4);
<a name="__line536"></a>	const int cols = f.components();
<a name="__line537"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line538"></a>	{
<a name="__line539"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line540"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line541"></a>	}
<a name="__line542"></a>
<a name="__line543"></a>	datapoint p(cols);
<a name="__line544"></a>	vector&lt;var&gt; args(3);
<a name="__line545"></a>	const unsigned int npoints = std::min(std::min(x.size(), y.size()),z.size());
<a name="__line546"></a>	for(unsigned int i=0; i&lt;npoints; ++i)
<a name="__line547"></a>	{
<a name="__line548"></a>            function::clear_named_params();
<a name="__line549"></a>	    function::named_param("linenumber",i);
<a name="__line550"></a>	    args[0] = x[i];
<a name="__line551"></a>	    args[1] = y[i];
<a name="__line552"></a>	    args[2] = z[i];
<a name="__line553"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line554"></a>	    if(f.initialized())
<a name="__line555"></a>	    {
<a name="__line556"></a>		f.meval(args,p);
<a name="__line557"></a>		g-&gt;add(p);
<a name="__line558"></a>	    }
<a name="__line559"></a>	    else
<a name="__line560"></a>	    {
<a name="__line561"></a>		g-&gt;add(args);
<a name="__line562"></a>	    }
<a name="__line563"></a>	}
<a name="__line564"></a>        function::clear_named_params();
<a name="__line565"></a>	return *g;
<a name="__line566"></a>    }
<a name="__line567"></a>    dgraph &amp;mplot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line568"></a>		     const std::vector&lt;var&gt; &amp;y,
<a name="__line569"></a>		     const std::vector&lt;var&gt; &amp;z,
<a name="__line570"></a>		     const std::vector&lt;var&gt; &amp;w,
<a name="__line571"></a>		     const function &amp;condition,
<a name="__line572"></a>		     const function &amp;f1,
<a name="__line573"></a>		     const function &amp;f2,
<a name="__line574"></a>		     const function &amp;f3,
<a name="__line575"></a>		     const function &amp;f4)
<a name="__line576"></a>    {
<a name="__line577"></a>	dgraph *g = new dgraph;
<a name="__line578"></a>	g-&gt;autodel(true);
<a name="__line579"></a>	frame::current().add(g);
<a name="__line580"></a>	if(condition.nargs() &gt; 4)
<a name="__line581"></a>	{
<a name="__line582"></a>	    warning::print("Data arrays have insufficient columns to execute condition",
<a name="__line583"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function&amp; condition, ....)");
<a name="__line584"></a>	    return *g;
<a name="__line585"></a>	}
<a name="__line586"></a>
<a name="__line587"></a>	function f(f1,f2,f3,f4);
<a name="__line588"></a>	const int cols = f.components();
<a name="__line589"></a>	if(f.initialized() &amp;&amp; cols&lt;2)
<a name="__line590"></a>	{
<a name="__line591"></a>	    warning::print("Filter functions produce less than 2 columns",
<a name="__line592"></a>			   "mplot_if(vector&lt;var&gt;&amp;,function &amp;condition,function &amp;f1..)");
<a name="__line593"></a>	}
<a name="__line594"></a>
<a name="__line595"></a>	datapoint p(cols);
<a name="__line596"></a>	vector&lt;var&gt; args(4);
<a name="__line597"></a>	const unsigned int npoints = std::min(std::min(x.size(), y.size()),z.size());
<a name="__line598"></a>	for(unsigned int i=0; i&lt;npoints; ++i)
<a name="__line599"></a>	{
<a name="__line600"></a>            function::clear_named_params();
<a name="__line601"></a>	    function::named_param("linenumber",i);
<a name="__line602"></a>	    args[0] = x[i];
<a name="__line603"></a>	    args[1] = y[i];
<a name="__line604"></a>	    args[2] = z[i];
<a name="__line605"></a>	    args[3] = w[i];
<a name="__line606"></a>	    if(condition.eval(args).dbl() == 0.0) continue;
<a name="__line607"></a>	    if(f.initialized())
<a name="__line608"></a>	    {
<a name="__line609"></a>		f.meval(args,p);
<a name="__line610"></a>		g-&gt;add(p);
<a name="__line611"></a>	    }
<a name="__line612"></a>	    else
<a name="__line613"></a>	    {
<a name="__line614"></a>		g-&gt;add(args);
<a name="__line615"></a>	    }
<a name="__line616"></a>	}
<a name="__line617"></a>        function::clear_named_params();
<a name="__line618"></a>	return *g;
<a name="__line619"></a>    }
<a name="__line620"></a>
<a name="__line621"></a>    dgraph &amp;plot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line622"></a>		    const function &amp;condition,
<a name="__line623"></a>		    const function &amp;f1,
<a name="__line624"></a>		    const function &amp;f2,
<a name="__line625"></a>		    const function &amp;f3,
<a name="__line626"></a>		    const function &amp;f4)
<a name="__line627"></a>    {
<a name="__line628"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line629"></a>	return mplot_if(x,condition,f1,f2,f3,f4);
<a name="__line630"></a>    }
<a name="__line631"></a>    dgraph &amp;plot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line632"></a>		    const std::vector&lt;var&gt; &amp;y,
<a name="__line633"></a>		    const function &amp;condition,
<a name="__line634"></a>		    const function &amp;f1,
<a name="__line635"></a>		    const function &amp;f2,
<a name="__line636"></a>		    const function &amp;f3,
<a name="__line637"></a>		    const function &amp;f4)
<a name="__line638"></a>    {
<a name="__line639"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line640"></a>	return mplot_if(x,y,condition,f1,f2,f3,f4);
<a name="__line641"></a>    }
<a name="__line642"></a>    dgraph &amp;plot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line643"></a>		    const std::vector&lt;var&gt; &amp;y,
<a name="__line644"></a>		    const std::vector&lt;var&gt; &amp;z,
<a name="__line645"></a>		    const function &amp;condition,
<a name="__line646"></a>		    const function &amp;f1,
<a name="__line647"></a>		    const function &amp;f2,
<a name="__line648"></a>		    const function &amp;f3,
<a name="__line649"></a>		    const function &amp;f4)
<a name="__line650"></a>    {
<a name="__line651"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line652"></a>	return mplot_if(x,y,z,condition,f1,f2,f3,f4);
<a name="__line653"></a>    }
<a name="__line654"></a>    dgraph &amp;plot_if(const std::vector&lt;var&gt; &amp;x,
<a name="__line655"></a>		    const std::vector&lt;var&gt; &amp;y,
<a name="__line656"></a>		    const std::vector&lt;var&gt; &amp;z,
<a name="__line657"></a>		    const std::vector&lt;var&gt; &amp;w,
<a name="__line658"></a>		    const function &amp;condition,
<a name="__line659"></a>		    const function &amp;f1,
<a name="__line660"></a>		    const function &amp;f2,
<a name="__line661"></a>		    const function &amp;f3,
<a name="__line662"></a>		    const function &amp;f4)
<a name="__line663"></a>    {
<a name="__line664"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line665"></a>	return mplot_if(x,y,z,w,condition,f1,f2,f3,f4);
<a name="__line666"></a>    }
<a name="__line667"></a>
<a name="__line668"></a>
<a name="__line669"></a>    <span class=comment>// --------------------------------------------------------------------------------</span>
<a name="__line670"></a>
<a name="__line671"></a>    dgraph &amp;mplot_if(dgraph &amp;g,
<a name="__line672"></a>		     const function &amp;condition,
<a name="__line673"></a>		     const function &amp;f1,
<a name="__line674"></a>		     const function &amp;f2,
<a name="__line675"></a>		     const function &amp;f3,
<a name="__line676"></a>		     const function &amp;f4)
<a name="__line677"></a>    {
<a name="__line678"></a>	dgraph *gg = new dgraph;
<a name="__line679"></a>	gg-&gt;autodel(true);
<a name="__line680"></a>	gg-&gt;copy_style(g);
<a name="__line681"></a>	frame::current().add(gg);
<a name="__line682"></a>
<a name="__line683"></a>	if(condition.nargs() &gt; g.columns())
<a name="__line684"></a>	{
<a name="__line685"></a>	    warning::print("Graph has insufficient columns to execute condition",
<a name="__line686"></a>			   "mplot_if(dgraph&amp;,function&amp; condition, ....)");
<a name="__line687"></a>	    return *gg;
<a name="__line688"></a>	}
<a name="__line689"></a>
<a name="__line690"></a>	function f(f1,f2,f3,f4);
<a name="__line691"></a>	int cols = f.components();
<a name="__line692"></a>
<a name="__line693"></a>	datapoint p(cols);
<a name="__line694"></a>	for(unsigned int i=0; i&lt;g.size(); ++i)
<a name="__line695"></a>	{
<a name="__line696"></a>            function::clear_named_params();
<a name="__line697"></a>	    function::named_param("linenumber",i);
<a name="__line698"></a>	    if(condition.eval(g[i]).dbl() == 0.0) continue;
<a name="__line699"></a>	    if(f.initialized())
<a name="__line700"></a>	    {
<a name="__line701"></a>		f.meval(g[i],p);
<a name="__line702"></a>		gg-&gt;add(p);
<a name="__line703"></a>	    }
<a name="__line704"></a>	    else
<a name="__line705"></a>	    {
<a name="__line706"></a>		gg-&gt;add(g[i]);
<a name="__line707"></a>	    }
<a name="__line708"></a>	}
<a name="__line709"></a>        function::clear_named_params();
<a name="__line710"></a>	return *gg;
<a name="__line711"></a>    }
<a name="__line712"></a>
<a name="__line713"></a>    
<a name="__line714"></a>    fgraph &amp;plot_if(const function &amp;condition,
<a name="__line715"></a>		    const function &amp;f1,
<a name="__line716"></a>		    const function &amp;f2,
<a name="__line717"></a>		    const function &amp;f3,
<a name="__line718"></a>		    const function &amp;f4)
<a name="__line719"></a>    {
<a name="__line720"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line721"></a>	return mplot_if(condition,f1,f2,f3,f4);
<a name="__line722"></a>    }
<a name="__line723"></a>
<a name="__line724"></a>    fgraph &amp;mplot_if(const function &amp;condition,
<a name="__line725"></a>		     const function &amp;f1,
<a name="__line726"></a>		     const function &amp;f2,
<a name="__line727"></a>		     const function &amp;f3,
<a name="__line728"></a>		     const function &amp;f4)
<a name="__line729"></a>    {
<a name="__line730"></a>	fgraph *g = new fgraph(function(f1,f2,f3,f4));
<a name="__line731"></a>	g-&gt;filter(condition);
<a name="__line732"></a>	g-&gt;autodel(true);
<a name="__line733"></a>	g-&gt;set_default_legend();
<a name="__line734"></a>	frame::current().add(g);
<a name="__line735"></a>	return *g;
<a name="__line736"></a>    }
<a name="__line737"></a>
<a name="__line738"></a>    dgraph &amp;plot(dgraph &amp;g,
<a name="__line739"></a>		 const function &amp;f1,
<a name="__line740"></a>		 const function &amp;f2,
<a name="__line741"></a>		 const function &amp;f3,
<a name="__line742"></a>		 const function &amp;f4)
<a name="__line743"></a>    {
<a name="__line744"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line745"></a>	return mplot(g,f1,f2,f3,f4);
<a name="__line746"></a>    }
<a name="__line747"></a>
<a name="__line748"></a>    dgraph &amp;plot_if(dgraph &amp;g,
<a name="__line749"></a>		    const function &amp;condition,
<a name="__line750"></a>		    const function &amp;f1,
<a name="__line751"></a>		    const function &amp;f2,
<a name="__line752"></a>		    const function &amp;f3,
<a name="__line753"></a>		    const function &amp;f4)
<a name="__line754"></a>    {
<a name="__line755"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line756"></a>	return mplot_if(g,condition,f1,f2,f3,f4);
<a name="__line757"></a>    }
<a name="__line758"></a>
<a name="__line759"></a>    hist &amp;hisplot(const var &amp;filename, const function &amp;f1, const function &amp;f2, const histopt &amp;hopt)
<a name="__line760"></a>    {
<a name="__line761"></a>        frame::current().clear_graphs_and_autosettings();
<a name="__line762"></a>        return mhisplot(filename,f1,f2,hopt);
<a name="__line763"></a>    }
<a name="__line764"></a>
<a name="__line765"></a>    hist &amp;mhisplot(const var &amp;filename, const function &amp;f1, const function &amp;f2, const histopt &amp;hopt)
<a name="__line766"></a>    {
<a name="__line767"></a>        hist *result = 0;
<a name="__line768"></a>        function filter;
<a name="__line769"></a>        if(f1.initialized()) filter.append(f1);
<a name="__line770"></a>        if(f2.initialized()) filter.append(f2);
<a name="__line771"></a>
<a name="__line772"></a>        bool needs_buffering = (hopt.buffer_size()&gt;0);
<a name="__line773"></a>        if(filter.components() == 2)
<a name="__line774"></a>        {
<a name="__line775"></a>            if(hopt.min(1)==unset || hopt.max(1)==unset || hopt.min(2)==unset || hopt.max(2)==unset) needs_buffering = true;
<a name="__line776"></a>            if(hopt.bins(1)==0 || hopt.bins(2)==0) needs_buffering = true;
<a name="__line777"></a>        }
<a name="__line778"></a>        else
<a name="__line779"></a>        {
<a name="__line780"></a>            if(hopt.min(1)==unset || hopt.max(1)==unset) needs_buffering = true;
<a name="__line781"></a>            if(hopt.bins(1)==0) needs_buffering = true;
<a name="__line782"></a>        }
<a name="__line783"></a>
<a name="__line784"></a>        istream *file = openin(filename);
<a name="__line785"></a>        int lineno = 0;
<a name="__line786"></a>        string line;
<a name="__line787"></a>        vector&lt;var&gt; input;
<a name="__line788"></a>        vector&lt;var&gt; filtered;
<a name="__line789"></a>        if(needs_buffering)
<a name="__line790"></a>        {
<a name="__line791"></a>            warning::print("Buffering in mhisplot should use the built-in buffering of 'hist'","mhisplot");
<a name="__line792"></a>
<a name="__line793"></a>            const unsigned int nbuffer = 2000;
<a name="__line794"></a>            
<a name="__line795"></a>            vector&lt;double&gt; buffer1, buffer2;
<a name="__line796"></a>            buffer1.reserve(nbuffer+10);
<a name="__line797"></a>            if(filter.components()&gt;=2) buffer2.reserve(nbuffer+10);
<a name="__line798"></a>            
<a name="__line799"></a>            
<a name="__line800"></a>            double min1=0, max1=0, min2=0, max2=0;
<a name="__line801"></a>            
<a name="__line802"></a>            <span class=comment>// First, process max 1000 data lines</span>
<a name="__line803"></a>            for(; getline(*file,line) &amp;&amp; buffer1.size()&lt;nbuffer; ++lineno)
<a name="__line804"></a>            {
<a name="__line805"></a>                function::clear_named_params();
<a name="__line806"></a>                function::named_param("linenumber",lineno);
<a name="__line807"></a>                split_quoted(line,input);
<a name="__line808"></a>                
<a name="__line809"></a>                <span class=comment>// skip empty or comment lines</span>
<a name="__line810"></a>                if(input.empty()) continue;
<a name="__line811"></a>                if(input[0][0] == '#') continue;
<a name="__line812"></a>                
<a name="__line813"></a>                if(filter.initialized() &amp;&amp; filter.components()&gt;=1)
<a name="__line814"></a>                {
<a name="__line815"></a>                    filter.meval(input,filtered);
<a name="__line816"></a>                    
<a name="__line817"></a>                    if(buffer1.empty() || filtered[0].dbl()&lt;min1) min1 = filtered[0].dbl();
<a name="__line818"></a>                    if(buffer1.empty() || filtered[0].dbl()&gt;max1) max1 = filtered[0].dbl();
<a name="__line819"></a>                    buffer1.push_back(filtered[0].dbl());
<a name="__line820"></a>                    
<a name="__line821"></a>                    if(filter.components()&gt;=2)
<a name="__line822"></a>                    {
<a name="__line823"></a>                        if(buffer2.empty() || filtered[1].dbl()&lt;min2) min2 = filtered[1].dbl();
<a name="__line824"></a>                        if(buffer2.empty() || filtered[1].dbl()&gt;max2) max2 = filtered[1].dbl();
<a name="__line825"></a>                        buffer2.push_back(filtered[1].dbl());
<a name="__line826"></a>                    }
<a name="__line827"></a>                }
<a name="__line828"></a>                else
<a name="__line829"></a>                {
<a name="__line830"></a>                    for(unsigned int i=0; i&lt;input.size(); ++i)
<a name="__line831"></a>                    {
<a name="__line832"></a>                        if(buffer1.empty() || input[i].dbl()&lt;min1) min1=input[i].dbl();
<a name="__line833"></a>                        if(buffer1.empty() || input[i].dbl()&gt;max1) max1=input[i].dbl();
<a name="__line834"></a>                        buffer1.push_back(input[i].dbl());
<a name="__line835"></a>                    }
<a name="__line836"></a>                }
<a name="__line837"></a>            }
<a name="__line838"></a>            function::clear_named_params();
<a name="__line839"></a>            <span class=comment>// We have processed the first 2000 lines. Now we have enough statistics (hopefully) to estimate</span>
<a name="__line840"></a>            <span class=comment>// the histogra ranges</span>
<a name="__line841"></a>            
<a name="__line842"></a>            double range1 = max1-min1;
<a name="__line843"></a>            min1 -= range1/10;
<a name="__line844"></a>            max1 += range1/10;
<a name="__line845"></a>            int nbins = std::min(std::max(20,(int)(buffer1.size())/10),80);
<a name="__line846"></a>
<a name="__line847"></a>            <span class=comment>// If the range is nearly symmetric around 0, make it symmetric</span>
<a name="__line848"></a>            if(min1*max1&lt;0 &amp;&amp; (::fabs(min1)-::fabs(max1))/(::fabs(min1)+::fabs(max1))&lt;0.05)
<a name="__line849"></a>            {
<a name="__line850"></a>                max1 = std::max(::fabs(min1),::fabs(max1));
<a name="__line851"></a>                min1 = -max1;
<a name="__line852"></a>            }
<a name="__line853"></a>
<a name="__line854"></a>            if(filter.components()&gt;=2)
<a name="__line855"></a>            {
<a name="__line856"></a>                double range2 = max2-min2;
<a name="__line857"></a>                min2 -= range2/10;
<a name="__line858"></a>                max2 += range2/10;
<a name="__line859"></a>
<a name="__line860"></a>
<a name="__line861"></a>                <span class=comment>// If the range is nearly symmetric around 0, make it symmetric</span>
<a name="__line862"></a>                if(min2*max2&lt;0 &amp;&amp; (::fabs(min2)-::fabs(max2))/(::fabs(min2)+::fabs(max2))&lt;0.05)
<a name="__line863"></a>                {
<a name="__line864"></a>                    max2 = std::max(::fabs(min2),::fabs(max2));
<a name="__line865"></a>                    min2 = -max2;
<a name="__line866"></a>                }
<a name="__line867"></a>
<a name="__line868"></a>                <span class=comment>//cerr&lt;&lt;"Creating 2D histogram: "&lt;&lt;endl;</span>
<a name="__line869"></a>                <span class=comment>//cerr&lt;&lt;"  "&lt;&lt;nbins&lt;&lt;" bins: "&lt;&lt;min1&lt;&lt;" .. "&lt;&lt;max1&lt;&lt;endl;</span>
<a name="__line870"></a>                <span class=comment>//cerr&lt;&lt;"  "&lt;&lt;nbins&lt;&lt;" bins: "&lt;&lt;min2&lt;&lt;" .. "&lt;&lt;max2&lt;&lt;endl;</span>
<a name="__line871"></a>
<a name="__line872"></a>                result = new hist(hopt.min(1)==unset?min1:hopt.min(1),
<a name="__line873"></a>                                  hopt.max(1)==unset?max1:hopt.max(1),
<a name="__line874"></a>                                  hopt.bins(1)==0?nbins:hopt.bins(1),
<a name="__line875"></a>                                  hopt.min(2)==unset?min2:hopt.min(2),
<a name="__line876"></a>                                  hopt.max(2)==unset?max2:hopt.max(2),
<a name="__line877"></a>                                  hopt.bins(2)==0?nbins:hopt.bins(2));
<a name="__line878"></a>            }
<a name="__line879"></a>            else
<a name="__line880"></a>            {
<a name="__line881"></a>                <span class=comment>//cerr&lt;&lt;"Creating 1D histogram: "&lt;&lt;endl;</span>
<a name="__line882"></a>                <span class=comment>//cerr&lt;&lt;"  "&lt;&lt;nbins&lt;&lt;" bins: "&lt;&lt;min1&lt;&lt;" .. "&lt;&lt;max1&lt;&lt;endl;</span>
<a name="__line883"></a>                result = new hist(hopt.min(1)==unset?min1:hopt.min(1),
<a name="__line884"></a>                                  hopt.max(1)==unset?max1:hopt.max(1),
<a name="__line885"></a>                                  hopt.bins(1)==0?nbins:hopt.bins(1));
<a name="__line886"></a>            }
<a name="__line887"></a>            
<a name="__line888"></a>            for(unsigned int i=0; i&lt;buffer1.size(); ++i)
<a name="__line889"></a>            {
<a name="__line890"></a>                if(filter.components()&gt;=2) result-&gt;fill(buffer1[i],buffer2[i]);
<a name="__line891"></a>                else                       result-&gt;fill(buffer1[i]);
<a name="__line892"></a>            }
<a name="__line893"></a>        }
<a name="__line894"></a>        else
<a name="__line895"></a>        {
<a name="__line896"></a>            if(filter.components()&gt;=2) result = new hist(hopt.min(1),hopt.max(1),hopt.bins(1),
<a name="__line897"></a>                                                         hopt.min(2),hopt.max(2),hopt.bins(2));
<a name="__line898"></a>            else                       result = new hist(hopt.min(1),hopt.max(1),hopt.bins(1));
<a name="__line899"></a>        }
<a name="__line900"></a>
<a name="__line901"></a>        <span class=comment>// read the rest of the file</span>
<a name="__line902"></a>
<a name="__line903"></a>        for(; getline(*file,line); ++lineno)
<a name="__line904"></a>        {
<a name="__line905"></a>            function::clear_named_params();
<a name="__line906"></a>            function::named_param("linenumber",lineno);
<a name="__line907"></a>            split_quoted(line,input);
<a name="__line908"></a>
<a name="__line909"></a>            <span class=comment>// skip empty or comment lines</span>
<a name="__line910"></a>            if(input.empty()) continue;
<a name="__line911"></a>            if(input[0][0] == '#') continue;
<a name="__line912"></a>
<a name="__line913"></a>            if(filter.initialized() &amp;&amp; filter.components()&gt;=1)
<a name="__line914"></a>            {
<a name="__line915"></a>                filter.meval(input,filtered);
<a name="__line916"></a>                if(filter.components()&gt;=2) result-&gt;fill(filtered[0].dbl(),filtered[1].dbl());
<a name="__line917"></a>                else                       result-&gt;fill(filtered[0].dbl());
<a name="__line918"></a>            }
<a name="__line919"></a>            else
<a name="__line920"></a>            {
<a name="__line921"></a>                for(unsigned int i=0; i&lt;input.size(); ++i) result-&gt;fill(input[i].dbl());
<a name="__line922"></a>            }
<a name="__line923"></a>        }
<a name="__line924"></a>        function::clear_named_params();
<a name="__line925"></a>
<a name="__line926"></a>        delete file;
<a name="__line927"></a>
<a name="__line928"></a>        result-&gt;autodel(true);
<a name="__line929"></a>        frame::current().add(result);
<a name="__line930"></a>        return *result;
<a name="__line931"></a>    }
<a name="__line932"></a>
<a name="__line933"></a>    dgraph &amp;plot(const var &amp;filename,
<a name="__line934"></a>		 const function &amp;f1,
<a name="__line935"></a>		 const function &amp;f2,
<a name="__line936"></a>		 const function &amp;f3,
<a name="__line937"></a>		 const function &amp;f4,
<a name="__line938"></a>		 const function &amp;f5,
<a name="__line939"></a>		 const function &amp;f6)
<a name="__line940"></a>    {
<a name="__line941"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line942"></a>	return mplot(filename, f1, f2, f3, f4, f5, f6);
<a name="__line943"></a>    }
<a name="__line944"></a>
<a name="__line945"></a>    dgraph &amp;mplot(const var &amp;filename,
<a name="__line946"></a>		  const function &amp;f1,
<a name="__line947"></a>		  const function &amp;f2,
<a name="__line948"></a>		  const function &amp;f3,
<a name="__line949"></a>		  const function &amp;f4,
<a name="__line950"></a>		  const function &amp;f5,
<a name="__line951"></a>		  const function &amp;f6)
<a name="__line952"></a>    {
<a name="__line953"></a>	dgraph *g = new dgraph;
<a name="__line954"></a>	g-&gt;autodel(true);
<a name="__line955"></a>	function filter;
<a name="__line956"></a>	filter.append(f1);
<a name="__line957"></a>	filter.append(f2);
<a name="__line958"></a>	filter.append(f3);
<a name="__line959"></a>	filter.append(f4);
<a name="__line960"></a>	filter.append(f5);
<a name="__line961"></a>	filter.append(f6);
<a name="__line962"></a>	g-&gt;read(filename, filter);
<a name="__line963"></a>	frame::current().add(g);
<a name="__line964"></a>	return *g;
<a name="__line965"></a>    }
<a name="__line966"></a>
<a name="__line967"></a>    <span class=comment>// --------------------------------------------------------------------------------</span>
<a name="__line968"></a>
<a name="__line969"></a>    dgraph &amp;plot(int n,
<a name="__line970"></a>		 double *x,
<a name="__line971"></a>		 const function &amp;f1,
<a name="__line972"></a>		 const function &amp;f2,
<a name="__line973"></a>		 const function &amp;f3,
<a name="__line974"></a>		 const function &amp;f4)
<a name="__line975"></a>    {
<a name="__line976"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line977"></a>	return mplot(n,x,f1,f2,f3,f4);
<a name="__line978"></a>    }
<a name="__line979"></a>    dgraph &amp;mplot(int n,
<a name="__line980"></a>		  double *x,
<a name="__line981"></a>		  const function &amp;f1,
<a name="__line982"></a>		  const function &amp;f2,
<a name="__line983"></a>		  const function &amp;f3,
<a name="__line984"></a>		  const function &amp;f4)
<a name="__line985"></a>    {
<a name="__line986"></a>	function transform(f1,f2,f3,f4);
<a name="__line987"></a>	dgraph *g = new dgraph(n,transform.components());
<a name="__line988"></a>	vector&lt;var&gt; in(1),out(transform.components());
<a name="__line989"></a>	for(int i=0; i&lt;n; ++i)
<a name="__line990"></a>	{
<a name="__line991"></a>            function::clear_named_params();
<a name="__line992"></a>	    function::named_param("linenumber",i);
<a name="__line993"></a>	    in[0] = x[i];
<a name="__line994"></a>	    transform.meval(in,out);
<a name="__line995"></a>	    for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line996"></a>	}
<a name="__line997"></a>        function::clear_named_params();
<a name="__line998"></a>	g-&gt;autodel(true);
<a name="__line999"></a>	frame::current().add(g);
<a name="__line1000"></a>	return *g;
<a name="__line1001"></a>    }
<a name="__line1002"></a>
<a name="__line1003"></a>    dgraph &amp;plot(int n,
<a name="__line1004"></a>		 double *x,
<a name="__line1005"></a>		 double *y,
<a name="__line1006"></a>		 const function &amp;f1,
<a name="__line1007"></a>		 const function &amp;f2,
<a name="__line1008"></a>		 const function &amp;f3,
<a name="__line1009"></a>		 const function &amp;f4)
<a name="__line1010"></a>    {
<a name="__line1011"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1012"></a>	return mplot(n,x,y,f1,f2,f3,f4);
<a name="__line1013"></a>    }
<a name="__line1014"></a>    dgraph &amp;mplot(int n,
<a name="__line1015"></a>		  double *x,
<a name="__line1016"></a>		  double *y,
<a name="__line1017"></a>		  const function &amp;f1,
<a name="__line1018"></a>		  const function &amp;f2,
<a name="__line1019"></a>		  const function &amp;f3,
<a name="__line1020"></a>		  const function &amp;f4)
<a name="__line1021"></a>    {
<a name="__line1022"></a>	dgraph *g = 0;
<a name="__line1023"></a>	if(f1.initialized())
<a name="__line1024"></a>	{
<a name="__line1025"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1026"></a>	    g = new dgraph(n,transform.components());
<a name="__line1027"></a>	    vector&lt;var&gt; in(2),out(transform.components());
<a name="__line1028"></a>	    for(int i=0; i&lt;n; ++i)
<a name="__line1029"></a>	    {
<a name="__line1030"></a>                function::clear_named_params();
<a name="__line1031"></a>		function::named_param("linenumber",i);
<a name="__line1032"></a>		in[0] = x[i];
<a name="__line1033"></a>		in[1] = y[i];
<a name="__line1034"></a>		transform.meval(in,out);
<a name="__line1035"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1036"></a>	    }
<a name="__line1037"></a>            function::clear_named_params();
<a name="__line1038"></a>	}
<a name="__line1039"></a>	else
<a name="__line1040"></a>	{
<a name="__line1041"></a>	    g = new dgraph(n,x,y);
<a name="__line1042"></a>	}
<a name="__line1043"></a>	g-&gt;autodel(true);
<a name="__line1044"></a>	frame::current().add(g);
<a name="__line1045"></a>	return *g;
<a name="__line1046"></a>    }
<a name="__line1047"></a>
<a name="__line1048"></a>    dgraph &amp;plot(int n,
<a name="__line1049"></a>		 double *x,
<a name="__line1050"></a>		 double *y,
<a name="__line1051"></a>		 double *z,
<a name="__line1052"></a>		 const function &amp;f1,
<a name="__line1053"></a>		 const function &amp;f2,
<a name="__line1054"></a>		 const function &amp;f3,
<a name="__line1055"></a>		 const function &amp;f4)
<a name="__line1056"></a>    {
<a name="__line1057"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1058"></a>	return mplot(n,x,y,z,f1,f2,f3,f4);
<a name="__line1059"></a>    }
<a name="__line1060"></a>    dgraph &amp;mplot(int n,
<a name="__line1061"></a>		  double *x,
<a name="__line1062"></a>		  double *y,
<a name="__line1063"></a>		  double *z,
<a name="__line1064"></a>		  const function &amp;f1,
<a name="__line1065"></a>		  const function &amp;f2,
<a name="__line1066"></a>		  const function &amp;f3,
<a name="__line1067"></a>		  const function &amp;f4)
<a name="__line1068"></a>    {
<a name="__line1069"></a>	dgraph *g = 0;
<a name="__line1070"></a>	if(f1.initialized())
<a name="__line1071"></a>	{
<a name="__line1072"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1073"></a>	    g = new dgraph(n,transform.components());
<a name="__line1074"></a>	    vector&lt;var&gt; in(3),out(transform.components());
<a name="__line1075"></a>	    for(int i=0; i&lt;n; ++i)
<a name="__line1076"></a>	    {
<a name="__line1077"></a>                function::clear_named_params();
<a name="__line1078"></a>		function::named_param("linenumber",i);
<a name="__line1079"></a>		in[0] = x[i];
<a name="__line1080"></a>		in[1] = y[i];
<a name="__line1081"></a>		in[2] = z[i];
<a name="__line1082"></a>		transform.meval(in,out);
<a name="__line1083"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1084"></a>	    }
<a name="__line1085"></a>            function::clear_named_params();
<a name="__line1086"></a>	}
<a name="__line1087"></a>	else
<a name="__line1088"></a>	{
<a name="__line1089"></a>	    g = new dgraph(n,x,y,z);
<a name="__line1090"></a>	}
<a name="__line1091"></a>	g-&gt;autodel(true);
<a name="__line1092"></a>	frame::current().add(g);
<a name="__line1093"></a>	return *g;
<a name="__line1094"></a>    }
<a name="__line1095"></a>
<a name="__line1096"></a>    dgraph &amp;plot(int n,
<a name="__line1097"></a>		 double *x,
<a name="__line1098"></a>		 double *y,
<a name="__line1099"></a>		 double *z,
<a name="__line1100"></a>		 double *w,
<a name="__line1101"></a>		 const function &amp;f1,
<a name="__line1102"></a>		 const function &amp;f2,
<a name="__line1103"></a>		 const function &amp;f3,
<a name="__line1104"></a>		 const function &amp;f4)
<a name="__line1105"></a>    {
<a name="__line1106"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1107"></a>	return mplot(n,x,y,z,w,f1,f2,f3,f4);
<a name="__line1108"></a>    }
<a name="__line1109"></a>    dgraph &amp;mplot(int n,
<a name="__line1110"></a>		  double *x,
<a name="__line1111"></a>		  double *y,
<a name="__line1112"></a>		  double *z,
<a name="__line1113"></a>		  double *w,
<a name="__line1114"></a>		  const function &amp;f1,
<a name="__line1115"></a>		  const function &amp;f2,
<a name="__line1116"></a>		  const function &amp;f3,
<a name="__line1117"></a>		  const function &amp;f4)
<a name="__line1118"></a>    {
<a name="__line1119"></a>	dgraph *g = 0;
<a name="__line1120"></a>	if(f1.initialized())
<a name="__line1121"></a>	{
<a name="__line1122"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1123"></a>	    g = new dgraph(n,transform.components());
<a name="__line1124"></a>	    vector&lt;var&gt; in(4),out(transform.components());
<a name="__line1125"></a>	    for(int i=0; i&lt;n; ++i)
<a name="__line1126"></a>	    {
<a name="__line1127"></a>                function::clear_named_params();
<a name="__line1128"></a>		function::named_param("linenumber",i);
<a name="__line1129"></a>		in[0] = x[i];
<a name="__line1130"></a>		in[1] = y[i];
<a name="__line1131"></a>		in[2] = z[i];
<a name="__line1132"></a>		in[3] = w[i];
<a name="__line1133"></a>		transform.meval(in,out);
<a name="__line1134"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1135"></a>	    }
<a name="__line1136"></a>            function::clear_named_params();
<a name="__line1137"></a>	}
<a name="__line1138"></a>	else
<a name="__line1139"></a>	{
<a name="__line1140"></a>	    g = new dgraph(n,x,y,z,w);
<a name="__line1141"></a>	}
<a name="__line1142"></a>	g-&gt;autodel(true);
<a name="__line1143"></a>	frame::current().add(g);
<a name="__line1144"></a>	return *g;
<a name="__line1145"></a>    }
<a name="__line1146"></a>
<a name="__line1147"></a>    <span class=comment>// --------------------------------------------------------------------------------</span>
<a name="__line1148"></a>
<a name="__line1149"></a>    dgraph &amp;plot(int n,
<a name="__line1150"></a>		 var *x,
<a name="__line1151"></a>		 const function &amp;f1,
<a name="__line1152"></a>		 const function &amp;f2,
<a name="__line1153"></a>		 const function &amp;f3,
<a name="__line1154"></a>		 const function &amp;f4)
<a name="__line1155"></a>    {
<a name="__line1156"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1157"></a>	return mplot(n,x,f1,f2,f3,f4);
<a name="__line1158"></a>    }
<a name="__line1159"></a>    dgraph &amp;mplot(int n,
<a name="__line1160"></a>		  var *x,
<a name="__line1161"></a>		  const function &amp;f1,
<a name="__line1162"></a>		  const function &amp;f2,
<a name="__line1163"></a>		  const function &amp;f3,
<a name="__line1164"></a>		  const function &amp;f4)
<a name="__line1165"></a>    {
<a name="__line1166"></a>	function transform(f1,f2,f3,f4);
<a name="__line1167"></a>	dgraph *g = new dgraph(n,transform.components());
<a name="__line1168"></a>	vector&lt;var&gt; in(1),out(transform.components());
<a name="__line1169"></a>	for(int i=0; i&lt;n; ++i)
<a name="__line1170"></a>	{
<a name="__line1171"></a>            function::clear_named_params();
<a name="__line1172"></a>	    function::named_param("linenumber",i);
<a name="__line1173"></a>	    in[0] = x[i];
<a name="__line1174"></a>	    transform.meval(in,out);
<a name="__line1175"></a>	    for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1176"></a>	}
<a name="__line1177"></a>        function::clear_named_params();
<a name="__line1178"></a>	g-&gt;autodel(true);
<a name="__line1179"></a>	frame::current().add(g);
<a name="__line1180"></a>	return *g;
<a name="__line1181"></a>    }
<a name="__line1182"></a>
<a name="__line1183"></a>    dgraph &amp;plot(int n,
<a name="__line1184"></a>		 var *x,
<a name="__line1185"></a>		 var *y,
<a name="__line1186"></a>		 const function &amp;f1,
<a name="__line1187"></a>		 const function &amp;f2,
<a name="__line1188"></a>		 const function &amp;f3,
<a name="__line1189"></a>		 const function &amp;f4)
<a name="__line1190"></a>    {
<a name="__line1191"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1192"></a>	return mplot(n,x,y,f1,f2,f3,f4);
<a name="__line1193"></a>    }
<a name="__line1194"></a>    dgraph &amp;mplot(int n,
<a name="__line1195"></a>		  var *x,
<a name="__line1196"></a>		  var *y,
<a name="__line1197"></a>		  const function &amp;f1,
<a name="__line1198"></a>		  const function &amp;f2,
<a name="__line1199"></a>		  const function &amp;f3,
<a name="__line1200"></a>		  const function &amp;f4)
<a name="__line1201"></a>    {
<a name="__line1202"></a>	dgraph *g = 0;
<a name="__line1203"></a>	if(f1.initialized())
<a name="__line1204"></a>	{
<a name="__line1205"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1206"></a>	    g = new dgraph(n,transform.components());
<a name="__line1207"></a>	    vector&lt;var&gt; in(2),out(transform.components());
<a name="__line1208"></a>	    for(int i=0; i&lt;n; ++i)
<a name="__line1209"></a>	    {
<a name="__line1210"></a>                function::clear_named_params();
<a name="__line1211"></a>		function::named_param("linenumber",i);
<a name="__line1212"></a>		in[0] = x[i];
<a name="__line1213"></a>		in[1] = y[i];
<a name="__line1214"></a>		transform.meval(in,out);
<a name="__line1215"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1216"></a>	    }
<a name="__line1217"></a>            function::clear_named_params();
<a name="__line1218"></a>	}
<a name="__line1219"></a>	else
<a name="__line1220"></a>	{
<a name="__line1221"></a>	    g = new dgraph(n,x,y);
<a name="__line1222"></a>	}
<a name="__line1223"></a>	g-&gt;autodel(true);
<a name="__line1224"></a>	frame::current().add(g);
<a name="__line1225"></a>	return *g;
<a name="__line1226"></a>    }
<a name="__line1227"></a>
<a name="__line1228"></a>    dgraph &amp;plot(int n,
<a name="__line1229"></a>		 var *x,
<a name="__line1230"></a>		 var *y,
<a name="__line1231"></a>		 var *z,
<a name="__line1232"></a>		 const function &amp;f1,
<a name="__line1233"></a>		 const function &amp;f2,
<a name="__line1234"></a>		 const function &amp;f3,
<a name="__line1235"></a>		 const function &amp;f4)
<a name="__line1236"></a>    {
<a name="__line1237"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1238"></a>	return mplot(n,x,y,z,f1,f2,f3,f4);
<a name="__line1239"></a>    }
<a name="__line1240"></a>    dgraph &amp;mplot(int n,
<a name="__line1241"></a>		  var *x,
<a name="__line1242"></a>		  var *y,
<a name="__line1243"></a>		  var *z,
<a name="__line1244"></a>		  const function &amp;f1,
<a name="__line1245"></a>		  const function &amp;f2,
<a name="__line1246"></a>		  const function &amp;f3,
<a name="__line1247"></a>		  const function &amp;f4)
<a name="__line1248"></a>    {
<a name="__line1249"></a>	dgraph *g = 0;
<a name="__line1250"></a>	if(f1.initialized())
<a name="__line1251"></a>	{
<a name="__line1252"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1253"></a>	    g = new dgraph(n,transform.components());
<a name="__line1254"></a>	    vector&lt;var&gt; in(3),out(transform.components());
<a name="__line1255"></a>	    for(int i=0; i&lt;n; ++i)
<a name="__line1256"></a>	    {
<a name="__line1257"></a>                function::clear_named_params();
<a name="__line1258"></a>		function::named_param("linenumber",i);
<a name="__line1259"></a>		in[0] = x[i];
<a name="__line1260"></a>		in[1] = y[i];
<a name="__line1261"></a>		in[2] = z[i];
<a name="__line1262"></a>		transform.meval(in,out);
<a name="__line1263"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1264"></a>	    }
<a name="__line1265"></a>            function::clear_named_params();
<a name="__line1266"></a>	}
<a name="__line1267"></a>	else
<a name="__line1268"></a>	{
<a name="__line1269"></a>	    g = new dgraph(n,x,y,z);
<a name="__line1270"></a>	}
<a name="__line1271"></a>	g-&gt;autodel(true);
<a name="__line1272"></a>	frame::current().add(g);
<a name="__line1273"></a>	return *g;
<a name="__line1274"></a>    }
<a name="__line1275"></a>
<a name="__line1276"></a>    dgraph &amp;plot(int n,
<a name="__line1277"></a>		 var *x,
<a name="__line1278"></a>		 var *y,
<a name="__line1279"></a>		 var *z,
<a name="__line1280"></a>		 var *w,
<a name="__line1281"></a>		 const function &amp;f1,
<a name="__line1282"></a>		 const function &amp;f2,
<a name="__line1283"></a>		 const function &amp;f3,
<a name="__line1284"></a>		 const function &amp;f4)
<a name="__line1285"></a>    {
<a name="__line1286"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1287"></a>	return mplot(n,x,y,z,w,f1,f2,f3,f4);
<a name="__line1288"></a>    }
<a name="__line1289"></a>    dgraph &amp;mplot(int n,
<a name="__line1290"></a>		  var *x,
<a name="__line1291"></a>		  var *y,
<a name="__line1292"></a>		  var *z,
<a name="__line1293"></a>		  var *w,
<a name="__line1294"></a>		  const function &amp;f1,
<a name="__line1295"></a>		  const function &amp;f2,
<a name="__line1296"></a>		  const function &amp;f3,
<a name="__line1297"></a>		  const function &amp;f4)
<a name="__line1298"></a>    {
<a name="__line1299"></a>	dgraph *g = 0;
<a name="__line1300"></a>	if(f1.initialized())
<a name="__line1301"></a>	{
<a name="__line1302"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1303"></a>	    g = new dgraph(n,transform.components());
<a name="__line1304"></a>	    vector&lt;var&gt; in(4),out(transform.components());
<a name="__line1305"></a>	    for(int i=0; i&lt;n; ++i)
<a name="__line1306"></a>	    {
<a name="__line1307"></a>                function::clear_named_params();
<a name="__line1308"></a>		function::named_param("linenumber",i);
<a name="__line1309"></a>		in[0] = x[i];
<a name="__line1310"></a>		in[1] = y[i];
<a name="__line1311"></a>		in[2] = z[i];
<a name="__line1312"></a>		in[3] = w[i];
<a name="__line1313"></a>		transform.meval(in,out);
<a name="__line1314"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1315"></a>	    }
<a name="__line1316"></a>            function::clear_named_params();
<a name="__line1317"></a>	}
<a name="__line1318"></a>	else
<a name="__line1319"></a>	{
<a name="__line1320"></a>	    g = new dgraph(n,x,y,z,w);
<a name="__line1321"></a>	}
<a name="__line1322"></a>	g-&gt;autodel(true);
<a name="__line1323"></a>	frame::current().add(g);
<a name="__line1324"></a>	return *g;
<a name="__line1325"></a>    }
<a name="__line1326"></a>
<a name="__line1327"></a>
<a name="__line1328"></a>
<a name="__line1329"></a>
<a name="__line1330"></a>    <span class=comment>// --------------------------------------------------------------------------------</span>
<a name="__line1331"></a>
<a name="__line1332"></a>    dgraph &amp;plot(double x, double y)
<a name="__line1333"></a>    {
<a name="__line1334"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1335"></a>	return mplot(x,y);
<a name="__line1336"></a>    }
<a name="__line1337"></a>    dgraph &amp;mplot(double x, double y)
<a name="__line1338"></a>    {
<a name="__line1339"></a>	dgraph *g = new dgraph(1,&amp;x,&amp;y);
<a name="__line1340"></a>	g-&gt;autodel(true);
<a name="__line1341"></a>	g-&gt;drawstyle(points());
<a name="__line1342"></a>	frame::current().add(g);
<a name="__line1343"></a>	return *g;
<a name="__line1344"></a>    }
<a name="__line1345"></a>    dgraph &amp;plot(double x, var y)
<a name="__line1346"></a>    {
<a name="__line1347"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1348"></a>	return mplot(x,y);
<a name="__line1349"></a>    }
<a name="__line1350"></a>    dgraph &amp;mplot(double x, var y)
<a name="__line1351"></a>    {
<a name="__line1352"></a>	dgraph *g = new dgraph;
<a name="__line1353"></a>        g-&gt;add(x,y);
<a name="__line1354"></a>	g-&gt;autodel(true);
<a name="__line1355"></a>	g-&gt;drawstyle(points());
<a name="__line1356"></a>	frame::current().add(g);
<a name="__line1357"></a>	return *g;
<a name="__line1358"></a>    }
<a name="__line1359"></a>    dgraph &amp;plot(var x, double y)
<a name="__line1360"></a>    {
<a name="__line1361"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1362"></a>	return mplot(x,y);
<a name="__line1363"></a>    }
<a name="__line1364"></a>    dgraph &amp;mplot(var x, double y)
<a name="__line1365"></a>    {
<a name="__line1366"></a>	dgraph *g = new dgraph;
<a name="__line1367"></a>        g-&gt;add(x,y);
<a name="__line1368"></a>	g-&gt;autodel(true);
<a name="__line1369"></a>	g-&gt;drawstyle(points());
<a name="__line1370"></a>	frame::current().add(g);
<a name="__line1371"></a>	return *g;
<a name="__line1372"></a>    }
<a name="__line1373"></a>
<a name="__line1374"></a>    dgraph &amp;plot(double x, double y, double z)
<a name="__line1375"></a>    {
<a name="__line1376"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1377"></a>	return mplot(x,y,z);
<a name="__line1378"></a>    }
<a name="__line1379"></a>    dgraph &amp;mplot(double x, double y, double z)
<a name="__line1380"></a>    {
<a name="__line1381"></a>	dgraph *g = new dgraph(1,&amp;x,&amp;y,&amp;z);
<a name="__line1382"></a>	g-&gt;autodel(true);
<a name="__line1383"></a>	g-&gt;drawstyle(points());
<a name="__line1384"></a>	frame::current().add(g);
<a name="__line1385"></a>	return *g;
<a name="__line1386"></a>    }
<a name="__line1387"></a>
<a name="__line1388"></a>    dgraph &amp;plot(double x, double y, var z)
<a name="__line1389"></a>    {
<a name="__line1390"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1391"></a>	return mplot(x,y,z);
<a name="__line1392"></a>    }
<a name="__line1393"></a>    dgraph &amp;mplot(double x, double y, var z)
<a name="__line1394"></a>    {
<a name="__line1395"></a>	dgraph *g = new dgraph;
<a name="__line1396"></a>        g-&gt;add(x,y,z);
<a name="__line1397"></a>	g-&gt;autodel(true);
<a name="__line1398"></a>	g-&gt;drawstyle(points());
<a name="__line1399"></a>	frame::current().add(g);
<a name="__line1400"></a>	return *g;
<a name="__line1401"></a>    }
<a name="__line1402"></a>
<a name="__line1403"></a>
<a name="__line1404"></a>    dgraph &amp;plot(const var &amp;x, const var &amp;y, const var &amp;z)
<a name="__line1405"></a>    {
<a name="__line1406"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1407"></a>	return mplot(x,y,z);
<a name="__line1408"></a>    }
<a name="__line1409"></a>    dgraph &amp;mplot(const var &amp;x, const var &amp;y, const var &amp;z)
<a name="__line1410"></a>    {
<a name="__line1411"></a>	dgraph *g = 0;
<a name="__line1412"></a>	if(z.dbl() != unset) g = new dgraph(1,&amp;x,&amp;y,&amp;z);
<a name="__line1413"></a>	else                 g = new dgraph(1,&amp;x,&amp;y);
<a name="__line1414"></a>	g-&gt;autodel(true);
<a name="__line1415"></a>	g-&gt;drawstyle(points());
<a name="__line1416"></a>	frame::current().add(g);
<a name="__line1417"></a>	return *g;
<a name="__line1418"></a>    }
<a name="__line1419"></a>
<a name="__line1420"></a>
<a name="__line1421"></a>    dgraph &amp;plot(const vector&lt;double&gt; &amp;x,
<a name="__line1422"></a>		 const function &amp;f1,
<a name="__line1423"></a>		 const function &amp;f2,
<a name="__line1424"></a>		 const function &amp;f3,
<a name="__line1425"></a>		 const function &amp;f4)
<a name="__line1426"></a>    {
<a name="__line1427"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1428"></a>	return mplot(x,f1,f2,f3,f4);
<a name="__line1429"></a>    }
<a name="__line1430"></a>    dgraph &amp;mplot(const vector&lt;double&gt; &amp;x,
<a name="__line1431"></a>		  const function &amp;f1,
<a name="__line1432"></a>		  const function &amp;f2,
<a name="__line1433"></a>		  const function &amp;f3,
<a name="__line1434"></a>		  const function &amp;f4)
<a name="__line1435"></a>    {
<a name="__line1436"></a>	unsigned int n=x.size();
<a name="__line1437"></a>	function transform(f1,f2,f3,f4);
<a name="__line1438"></a>	dgraph *g = new dgraph(n,transform.components());
<a name="__line1439"></a>	vector&lt;var&gt; in(1),out(transform.components());
<a name="__line1440"></a>	for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1441"></a>	{
<a name="__line1442"></a>            function::clear_named_params();
<a name="__line1443"></a>	    function::named_param("linenumber",i);
<a name="__line1444"></a>	    in[0] = x[i];
<a name="__line1445"></a>	    transform.meval(in,out);
<a name="__line1446"></a>	    for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1447"></a>	}
<a name="__line1448"></a>        function::clear_named_params();
<a name="__line1449"></a>	g-&gt;autodel(true);
<a name="__line1450"></a>	frame::current().add(g);
<a name="__line1451"></a>	return *g;
<a name="__line1452"></a>    }
<a name="__line1453"></a>
<a name="__line1454"></a>    dgraph &amp;plot(const vector&lt;double&gt; &amp;x,
<a name="__line1455"></a>		 const vector&lt;double&gt; &amp;y,
<a name="__line1456"></a>		 const function &amp;f1,
<a name="__line1457"></a>		 const function &amp;f2,
<a name="__line1458"></a>		 const function &amp;f3,
<a name="__line1459"></a>		 const function &amp;f4)
<a name="__line1460"></a>    {
<a name="__line1461"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1462"></a>	return mplot(x,y,f1,f2,f3,f4);
<a name="__line1463"></a>    }
<a name="__line1464"></a>    dgraph &amp;mplot(const vector&lt;double&gt; &amp;x,
<a name="__line1465"></a>		  const vector&lt;double&gt; &amp;y,
<a name="__line1466"></a>		  const function &amp;f1,
<a name="__line1467"></a>		  const function &amp;f2,
<a name="__line1468"></a>		  const function &amp;f3,
<a name="__line1469"></a>		  const function &amp;f4)
<a name="__line1470"></a>    {
<a name="__line1471"></a>	dgraph *g = 0;
<a name="__line1472"></a>	unsigned int n=std::min(x.size(),y.size());
<a name="__line1473"></a>	if(f1.initialized())
<a name="__line1474"></a>	{
<a name="__line1475"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1476"></a>	    g = new dgraph(n,transform.components());
<a name="__line1477"></a>	    vector&lt;var&gt; in(2),out(transform.components());
<a name="__line1478"></a>	    for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1479"></a>	    {
<a name="__line1480"></a>                function::clear_named_params();
<a name="__line1481"></a>		function::named_param("linenumber",i);
<a name="__line1482"></a>		in[0] = x[i];
<a name="__line1483"></a>		in[1] = y[i];
<a name="__line1484"></a>		transform.meval(in,out);
<a name="__line1485"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1486"></a>	    }
<a name="__line1487"></a>            function::clear_named_params();
<a name="__line1488"></a>	}
<a name="__line1489"></a>	else
<a name="__line1490"></a>	{
<a name="__line1491"></a>	    g = new dgraph(x,y);
<a name="__line1492"></a>	}
<a name="__line1493"></a>	g-&gt;autodel(true);
<a name="__line1494"></a>	frame::current().add(g);
<a name="__line1495"></a>	return *g;
<a name="__line1496"></a>    }
<a name="__line1497"></a>
<a name="__line1498"></a>    dgraph &amp;plot(const vector&lt;double&gt; &amp;x,
<a name="__line1499"></a>		 const vector&lt;double&gt; &amp;y,
<a name="__line1500"></a>		 const vector&lt;double&gt; &amp;z,
<a name="__line1501"></a>		 const function &amp;f1,
<a name="__line1502"></a>		 const function &amp;f2,
<a name="__line1503"></a>		 const function &amp;f3,
<a name="__line1504"></a>		 const function &amp;f4)
<a name="__line1505"></a>    {
<a name="__line1506"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1507"></a>	return mplot(x,y,z,f1,f2,f3,f4);
<a name="__line1508"></a>    }
<a name="__line1509"></a>    dgraph &amp;mplot(const vector&lt;double&gt; &amp;x,
<a name="__line1510"></a>		  const vector&lt;double&gt; &amp;y,
<a name="__line1511"></a>		  const vector&lt;double&gt; &amp;z,
<a name="__line1512"></a>		  const function &amp;f1,
<a name="__line1513"></a>		  const function &amp;f2,
<a name="__line1514"></a>		  const function &amp;f3,
<a name="__line1515"></a>		  const function &amp;f4)
<a name="__line1516"></a>    {
<a name="__line1517"></a>	dgraph *g = 0;
<a name="__line1518"></a>	unsigned int n=std::min(std::min(x.size(),y.size()),z.size());
<a name="__line1519"></a>	if(f1.initialized())
<a name="__line1520"></a>	{
<a name="__line1521"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1522"></a>	    g = new dgraph(n,transform.components());
<a name="__line1523"></a>	    vector&lt;var&gt; in(3),out(transform.components());
<a name="__line1524"></a>	    for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1525"></a>	    {
<a name="__line1526"></a>                function::clear_named_params();
<a name="__line1527"></a>		function::named_param("linenumber",i);
<a name="__line1528"></a>		in[0] = x[i];
<a name="__line1529"></a>		in[1] = y[i];
<a name="__line1530"></a>		in[2] = z[i];
<a name="__line1531"></a>		transform.meval(in,out);
<a name="__line1532"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1533"></a>	    }
<a name="__line1534"></a>            function::clear_named_params();
<a name="__line1535"></a>	}
<a name="__line1536"></a>	else
<a name="__line1537"></a>	{
<a name="__line1538"></a>	    g = new dgraph(x,y,z);
<a name="__line1539"></a>	}
<a name="__line1540"></a>	g-&gt;autodel(true);
<a name="__line1541"></a>	frame::current().add(g);
<a name="__line1542"></a>	return *g;
<a name="__line1543"></a>    }
<a name="__line1544"></a>
<a name="__line1545"></a>    dgraph &amp;plot(const vector&lt;double&gt; &amp;x,
<a name="__line1546"></a>		 const vector&lt;double&gt; &amp;y,
<a name="__line1547"></a>		 const vector&lt;double&gt; &amp;z,
<a name="__line1548"></a>		 const vector&lt;double&gt; &amp;w,
<a name="__line1549"></a>		 const function &amp;f1,
<a name="__line1550"></a>		 const function &amp;f2,
<a name="__line1551"></a>		 const function &amp;f3,
<a name="__line1552"></a>		 const function &amp;f4)
<a name="__line1553"></a>    {
<a name="__line1554"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1555"></a>	return mplot(x,y,z,w,f1,f2,f3,f4);
<a name="__line1556"></a>    }
<a name="__line1557"></a>    dgraph &amp;mplot(const vector&lt;double&gt; &amp;x,
<a name="__line1558"></a>		  const vector&lt;double&gt; &amp;y,
<a name="__line1559"></a>		  const vector&lt;double&gt; &amp;z,
<a name="__line1560"></a>		  const vector&lt;double&gt; &amp;w,
<a name="__line1561"></a>		  const function &amp;f1,
<a name="__line1562"></a>		  const function &amp;f2,
<a name="__line1563"></a>		  const function &amp;f3,
<a name="__line1564"></a>		  const function &amp;f4)
<a name="__line1565"></a>    {
<a name="__line1566"></a>	dgraph *g = 0;
<a name="__line1567"></a>	unsigned int n=std::min(std::min(std::min(x.size(),y.size()),z.size()),w.size());
<a name="__line1568"></a>	if(f1.initialized())
<a name="__line1569"></a>	{
<a name="__line1570"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1571"></a>	    g = new dgraph(n,transform.components());
<a name="__line1572"></a>	    vector&lt;var&gt; in(4),out(transform.components());
<a name="__line1573"></a>	    for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1574"></a>	    {
<a name="__line1575"></a>                function::clear_named_params();
<a name="__line1576"></a>		function::named_param("linenumber",i);
<a name="__line1577"></a>		in[0] = x[i];
<a name="__line1578"></a>		in[1] = y[i];
<a name="__line1579"></a>		in[2] = z[i];
<a name="__line1580"></a>		in[3] = w[i];
<a name="__line1581"></a>		transform.meval(in,out);
<a name="__line1582"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1583"></a>	    }
<a name="__line1584"></a>            function::clear_named_params();
<a name="__line1585"></a>	}
<a name="__line1586"></a>	else
<a name="__line1587"></a>	{
<a name="__line1588"></a>	    g = new dgraph(x,y,z,w);
<a name="__line1589"></a>	}
<a name="__line1590"></a>	g-&gt;autodel(true);
<a name="__line1591"></a>	frame::current().add(g);
<a name="__line1592"></a>	return *g;
<a name="__line1593"></a>    }
<a name="__line1594"></a>
<a name="__line1595"></a>
<a name="__line1596"></a>    <span class=comment>// --------------------------------------------------------------------------------</span>
<a name="__line1597"></a>
<a name="__line1598"></a>
<a name="__line1599"></a>    dgraph &amp;plot(const vector&lt;var&gt; &amp;x,
<a name="__line1600"></a>		 const function &amp;f1,
<a name="__line1601"></a>		 const function &amp;f2,
<a name="__line1602"></a>		 const function &amp;f3,
<a name="__line1603"></a>		 const function &amp;f4)
<a name="__line1604"></a>    {
<a name="__line1605"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1606"></a>	return mplot(x,f1,f2,f3,f4);
<a name="__line1607"></a>    }
<a name="__line1608"></a>    dgraph &amp;mplot(const vector&lt;var&gt; &amp;x,
<a name="__line1609"></a>		  const function &amp;f1,
<a name="__line1610"></a>		  const function &amp;f2,
<a name="__line1611"></a>		  const function &amp;f3,
<a name="__line1612"></a>		  const function &amp;f4)
<a name="__line1613"></a>    {
<a name="__line1614"></a>	unsigned int n=x.size();
<a name="__line1615"></a>	function transform(f1,f2,f3,f4);
<a name="__line1616"></a>	dgraph *g = new dgraph(n,transform.components());
<a name="__line1617"></a>	vector&lt;var&gt; in(1),out(transform.components());
<a name="__line1618"></a>	for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1619"></a>	{
<a name="__line1620"></a>            function::clear_named_params();
<a name="__line1621"></a>	    function::named_param("linenumber",i);
<a name="__line1622"></a>	    in[0] = x[i];
<a name="__line1623"></a>	    transform.meval(in,out);
<a name="__line1624"></a>	    for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1625"></a>	}
<a name="__line1626"></a>        function::clear_named_params();
<a name="__line1627"></a>	g-&gt;autodel(true);
<a name="__line1628"></a>	frame::current().add(g);
<a name="__line1629"></a>	return *g;
<a name="__line1630"></a>    }
<a name="__line1631"></a>
<a name="__line1632"></a>    dgraph &amp;plot(const vector&lt;var&gt; &amp;x,
<a name="__line1633"></a>		 const vector&lt;var&gt; &amp;y,
<a name="__line1634"></a>		 const function &amp;f1,
<a name="__line1635"></a>		 const function &amp;f2,
<a name="__line1636"></a>		 const function &amp;f3,
<a name="__line1637"></a>		 const function &amp;f4)
<a name="__line1638"></a>    {
<a name="__line1639"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1640"></a>	return mplot(x,y,f1,f2,f3,f4);
<a name="__line1641"></a>    }
<a name="__line1642"></a>    dgraph &amp;mplot(const vector&lt;var&gt; &amp;x,
<a name="__line1643"></a>		  const vector&lt;var&gt; &amp;y,
<a name="__line1644"></a>		  const function &amp;f1,
<a name="__line1645"></a>		  const function &amp;f2,
<a name="__line1646"></a>		  const function &amp;f3,
<a name="__line1647"></a>		  const function &amp;f4)
<a name="__line1648"></a>    {
<a name="__line1649"></a>	dgraph *g = 0;
<a name="__line1650"></a>	unsigned int n=std::min(x.size(),y.size());
<a name="__line1651"></a>	if(f1.initialized())
<a name="__line1652"></a>	{
<a name="__line1653"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1654"></a>	    g = new dgraph(n,transform.components());
<a name="__line1655"></a>	    vector&lt;var&gt; in(2),out(transform.components());
<a name="__line1656"></a>	    for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1657"></a>	    {
<a name="__line1658"></a>                function::clear_named_params();
<a name="__line1659"></a>		function::named_param("linenumber",i);
<a name="__line1660"></a>		in[0] = x[i];
<a name="__line1661"></a>		in[1] = y[i];
<a name="__line1662"></a>		transform.meval(in,out);
<a name="__line1663"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1664"></a>	    }
<a name="__line1665"></a>            function::clear_named_params();
<a name="__line1666"></a>	}
<a name="__line1667"></a>	else
<a name="__line1668"></a>	{
<a name="__line1669"></a>	    g = new dgraph(x,y);
<a name="__line1670"></a>	}
<a name="__line1671"></a>	g-&gt;autodel(true);
<a name="__line1672"></a>	frame::current().add(g);
<a name="__line1673"></a>	return *g;
<a name="__line1674"></a>    }
<a name="__line1675"></a>
<a name="__line1676"></a>    dgraph &amp;plot(const vector&lt;var&gt; &amp;x,
<a name="__line1677"></a>		 const vector&lt;var&gt; &amp;y,
<a name="__line1678"></a>		 const vector&lt;var&gt; &amp;z,
<a name="__line1679"></a>		 const function &amp;f1,
<a name="__line1680"></a>		 const function &amp;f2,
<a name="__line1681"></a>		 const function &amp;f3,
<a name="__line1682"></a>		 const function &amp;f4)
<a name="__line1683"></a>    {
<a name="__line1684"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1685"></a>	return mplot(x,y,z,f1,f2,f3,f4);
<a name="__line1686"></a>    }
<a name="__line1687"></a>    dgraph &amp;mplot(const vector&lt;var&gt; &amp;x,
<a name="__line1688"></a>		  const vector&lt;var&gt; &amp;y,
<a name="__line1689"></a>		  const vector&lt;var&gt; &amp;z,
<a name="__line1690"></a>		  const function &amp;f1,
<a name="__line1691"></a>		  const function &amp;f2,
<a name="__line1692"></a>		  const function &amp;f3,
<a name="__line1693"></a>		  const function &amp;f4)
<a name="__line1694"></a>    {
<a name="__line1695"></a>	dgraph *g = 0;
<a name="__line1696"></a>	unsigned int n=std::min(std::min(x.size(),y.size()),z.size());
<a name="__line1697"></a>	if(f1.initialized())
<a name="__line1698"></a>	{
<a name="__line1699"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1700"></a>	    g = new dgraph(n,transform.components());
<a name="__line1701"></a>	    vector&lt;var&gt; in(3),out(transform.components());
<a name="__line1702"></a>	    for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1703"></a>	    {
<a name="__line1704"></a>                function::clear_named_params();
<a name="__line1705"></a>		function::named_param("linenumber",i);
<a name="__line1706"></a>		in[0] = x[i];
<a name="__line1707"></a>		in[1] = y[i];
<a name="__line1708"></a>		in[2] = z[i];
<a name="__line1709"></a>		transform.meval(in,out);
<a name="__line1710"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1711"></a>	    }
<a name="__line1712"></a>            function::clear_named_params();
<a name="__line1713"></a>	}
<a name="__line1714"></a>	else
<a name="__line1715"></a>	{
<a name="__line1716"></a>	    g = new dgraph(x,y,z);
<a name="__line1717"></a>	}
<a name="__line1718"></a>	g-&gt;autodel(true);
<a name="__line1719"></a>	frame::current().add(g);
<a name="__line1720"></a>	return *g;
<a name="__line1721"></a>    }
<a name="__line1722"></a>
<a name="__line1723"></a>    dgraph &amp;plot(const vector&lt;var&gt; &amp;x,
<a name="__line1724"></a>		 const vector&lt;var&gt; &amp;y,
<a name="__line1725"></a>		 const vector&lt;var&gt; &amp;z,
<a name="__line1726"></a>		 const vector&lt;var&gt; &amp;w,
<a name="__line1727"></a>		 const function &amp;f1,
<a name="__line1728"></a>		 const function &amp;f2,
<a name="__line1729"></a>		 const function &amp;f3,
<a name="__line1730"></a>		 const function &amp;f4)
<a name="__line1731"></a>    {
<a name="__line1732"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1733"></a>	return mplot(x,y,z,w,f1,f2,f3,f4);
<a name="__line1734"></a>    }
<a name="__line1735"></a>    dgraph &amp;mplot(const vector&lt;var&gt; &amp;x,
<a name="__line1736"></a>		  const vector&lt;var&gt; &amp;y,
<a name="__line1737"></a>		  const vector&lt;var&gt; &amp;z,
<a name="__line1738"></a>		  const vector&lt;var&gt; &amp;w,
<a name="__line1739"></a>		  const function &amp;f1,
<a name="__line1740"></a>		  const function &amp;f2,
<a name="__line1741"></a>		  const function &amp;f3,
<a name="__line1742"></a>		  const function &amp;f4)
<a name="__line1743"></a>    {
<a name="__line1744"></a>	dgraph *g = 0;
<a name="__line1745"></a>	unsigned int n=std::min(std::min(std::min(x.size(),y.size()),z.size()),w.size());
<a name="__line1746"></a>	if(f1.initialized())
<a name="__line1747"></a>	{
<a name="__line1748"></a>	    function transform(f1,f2,f3,f4);
<a name="__line1749"></a>	    g = new dgraph(n,transform.components());
<a name="__line1750"></a>	    vector&lt;var&gt; in(4),out(transform.components());
<a name="__line1751"></a>	    for(unsigned int i=0; i&lt;n; ++i)
<a name="__line1752"></a>	    {
<a name="__line1753"></a>                function::clear_named_params();
<a name="__line1754"></a>		function::named_param("linenumber",i);
<a name="__line1755"></a>		in[0] = x[i];
<a name="__line1756"></a>		in[1] = y[i];
<a name="__line1757"></a>		in[2] = z[i];
<a name="__line1758"></a>		in[3] = w[i];
<a name="__line1759"></a>		transform.meval(in,out);
<a name="__line1760"></a>		for(unsigned int j=0; j&lt;out.size(); ++j) (*g)[i][j] = out[j];
<a name="__line1761"></a>	    }
<a name="__line1762"></a>            function::clear_named_params();
<a name="__line1763"></a>	}
<a name="__line1764"></a>	else
<a name="__line1765"></a>	{
<a name="__line1766"></a>	    g = new dgraph(x,y,z,w);
<a name="__line1767"></a>	}
<a name="__line1768"></a>	g-&gt;autodel(true);
<a name="__line1769"></a>	frame::current().add(g);
<a name="__line1770"></a>	return *g;
<a name="__line1771"></a>    }
<a name="__line1772"></a>
<a name="__line1773"></a>
<a name="__line1774"></a>    <span class=comment>// --------------------------------------------------------------------------------</span>
<a name="__line1775"></a>
<a name="__line1776"></a>
<a name="__line1777"></a>     plottables plot_groups(const var &amp;filename,
<a name="__line1778"></a>                            const function &amp;grouping_value,
<a name="__line1779"></a>                            const function &amp;f1,
<a name="__line1780"></a>                            const function &amp;f2,
<a name="__line1781"></a>                            const function &amp;f3,
<a name="__line1782"></a>                            const function &amp;f4,
<a name="__line1783"></a>                            const function &amp;f5,
<a name="__line1784"></a>                            const function &amp;f6)
<a name="__line1785"></a>     {
<a name="__line1786"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1787"></a>	return mplot_groups(filename, grouping_value, f1, f2, f3, f4, f5, f6);
<a name="__line1788"></a>    }
<a name="__line1789"></a>
<a name="__line1790"></a>    plottables plot_groups_if(const var &amp;filename,
<a name="__line1791"></a>			       const function &amp;grouping_value,
<a name="__line1792"></a>			       const function &amp;condition,
<a name="__line1793"></a>			       const function &amp;f1,
<a name="__line1794"></a>			       const function &amp;f2,
<a name="__line1795"></a>			       const function &amp;f3,
<a name="__line1796"></a>			       const function &amp;f4,
<a name="__line1797"></a>			       const function &amp;f5,
<a name="__line1798"></a>			       const function &amp;f6)
<a name="__line1799"></a>    {
<a name="__line1800"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1801"></a>	return mplot_groups_if(filename, grouping_value, condition, f1, f2, f3, f4, f5, f6);
<a name="__line1802"></a>    }
<a name="__line1803"></a>
<a name="__line1804"></a>    plottables mplot_groups(const var &amp;filename,
<a name="__line1805"></a>			   const function &amp;grouping_value,
<a name="__line1806"></a>			   const function &amp;f1,
<a name="__line1807"></a>			   const function &amp;f2,
<a name="__line1808"></a>			   const function &amp;f3,
<a name="__line1809"></a>			   const function &amp;f4,
<a name="__line1810"></a>			   const function &amp;f5,
<a name="__line1811"></a>			   const function &amp;f6)
<a name="__line1812"></a>    {
<a name="__line1813"></a>	return mplot_groups_if(filename, grouping_value, unset, f1, f2, f3, f4, f5, f6);
<a name="__line1814"></a>    }
<a name="__line1815"></a>
<a name="__line1816"></a>
<a name="__line1817"></a>    plottables mplot_groups_if(const var &amp;filename,
<a name="__line1818"></a>				const function &amp;grouping_value,
<a name="__line1819"></a>				const function &amp;condition,
<a name="__line1820"></a>				const function &amp;f1,
<a name="__line1821"></a>				const function &amp;f2,
<a name="__line1822"></a>				const function &amp;f3,
<a name="__line1823"></a>				const function &amp;f4,
<a name="__line1824"></a>				const function &amp;f5,
<a name="__line1825"></a>				const function &amp;f6)
<a name="__line1826"></a>    {
<a name="__line1827"></a>	plottables graphs;
<a name="__line1828"></a>	function filter;
<a name="__line1829"></a>	filter.append(f1);
<a name="__line1830"></a>	filter.append(f2);
<a name="__line1831"></a>	filter.append(f3);
<a name="__line1832"></a>	filter.append(f4);
<a name="__line1833"></a>	filter.append(f5);
<a name="__line1834"></a>	filter.append(f6);
<a name="__line1835"></a>	dgraph::read_groups_if(filename, grouping_value, condition, filter, &amp;graphs);
<a name="__line1836"></a>	for(unsigned int i=0; i&lt;graphs.size(); ++i)
<a name="__line1837"></a>	{
<a name="__line1838"></a>	    graphs[i]-&gt;autodel(true);
<a name="__line1839"></a>	    frame::current().add(graphs[i]);
<a name="__line1840"></a>	}
<a name="__line1841"></a>	return graphs;
<a name="__line1842"></a>    }
<a name="__line1843"></a>
<a name="__line1844"></a>    <span class=comment>// ---------- plot many files (filename pattern) ----------------------------------</span>
<a name="__line1845"></a>
<a name="__line1846"></a>    plottables plot_many(const var &amp;filename_pattern,
<a name="__line1847"></a>			  const function &amp;f1,
<a name="__line1848"></a>			  const function &amp;f2,
<a name="__line1849"></a>			  const function &amp;f3,
<a name="__line1850"></a>			  const function &amp;f4,
<a name="__line1851"></a>			  const function &amp;f5,
<a name="__line1852"></a>			  const function &amp;f6)
<a name="__line1853"></a>    {
<a name="__line1854"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1855"></a>	return mplot_many(filename_pattern,f1,f2,f3,f4,f5,f6);
<a name="__line1856"></a>    }
<a name="__line1857"></a>
<a name="__line1858"></a>    plottables mplot_many(const var &amp;filename_pattern,
<a name="__line1859"></a>			   const function &amp;f1,
<a name="__line1860"></a>			   const function &amp;f2,
<a name="__line1861"></a>			   const function &amp;f3,
<a name="__line1862"></a>			   const function &amp;f4,
<a name="__line1863"></a>			   const function &amp;f5,
<a name="__line1864"></a>			   const function &amp;f6)
<a name="__line1865"></a>    {
<a name="__line1866"></a>	string cmd = filename_pattern.str();
<a name="__line1867"></a>	plottables graphs;
<a name="__line1868"></a>	if(cmd.find(" ") == string::npos) cmd = "echo " + cmd;
<a name="__line1869"></a>	ipstream filelist(cmd);
<a name="__line1870"></a>	string fn;
<a name="__line1871"></a>	while(filelist&gt;&gt;fn)
<a name="__line1872"></a>	{
<a name="__line1873"></a>	    graphs.add(&amp;mplot(fn,f1,f2,f3,f4,f5,f6).ac(autocolor).pt(autopoint()));
<a name="__line1874"></a>	}
<a name="__line1875"></a>	return graphs;
<a name="__line1876"></a>    }
<a name="__line1877"></a>
<a name="__line1878"></a>    <span class=comment>// ---------- plot with condition -------------------------------------------------</span>
<a name="__line1879"></a>
<a name="__line1880"></a>    dgraph &amp;plot_if(const var &amp;filename,
<a name="__line1881"></a>		    const function &amp;condition,
<a name="__line1882"></a>		    const function &amp;f1,
<a name="__line1883"></a>		    const function &amp;f2,
<a name="__line1884"></a>		    const function &amp;f3,
<a name="__line1885"></a>		    const function &amp;f4,
<a name="__line1886"></a>                    const function &amp;f5)
<a name="__line1887"></a>    {
<a name="__line1888"></a>	frame::current().clear_graphs_and_autosettings();
<a name="__line1889"></a>	return mplot_if(filename, condition, f1, f2, f3, f4, f5);
<a name="__line1890"></a>    }
<a name="__line1891"></a>    
<a name="__line1892"></a>    
<a name="__line1893"></a>    dgraph &amp;mplot_if(const var &amp;filename,
<a name="__line1894"></a>		     const function &amp;condition,
<a name="__line1895"></a>		     const function &amp;f1,
<a name="__line1896"></a>		     const function &amp;f2,
<a name="__line1897"></a>		     const function &amp;f3,
<a name="__line1898"></a>		     const function &amp;f4,
<a name="__line1899"></a>                     const function &amp;f5)
<a name="__line1900"></a>    {
<a name="__line1901"></a>	dgraph *g = new dgraph;
<a name="__line1902"></a>	g-&gt;autodel(true);
<a name="__line1903"></a>	<span class=comment>//function filter(f1,f2,f3,f4);</span>
<a name="__line1904"></a>	<span class=comment>//g-&gt;read_if(filename,condition,filter);</span>
<a name="__line1905"></a>        g-&gt;read_if(filename,condition,f1,f2,f3,f4,f5);
<a name="__line1906"></a>	frame::current().add(g);
<a name="__line1907"></a>	return *g;
<a name="__line1908"></a>    }
<a name="__line1909"></a>
<a name="__line1910"></a>}

</pre>
<hr> 
<a href="../index.html" title="Home"> 
<img src="../home.png"  style="border-width:0cm;"> 
</a>
<a href="source.html" title="List of sourcefiles"> 
<img src="../up.png"    style="border-width:0cm;"> 
</a>

</body></html>
